<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoCircuit | E-Waste AI & Rewards</title>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --primary: #10B981; 
            --primary-hover: #059669;
            --secondary: #3B82F6; 
            --dark: #111827; 
            --light: #F3F4F6; 
            --white: #ffffff;
            --gradient: linear-gradient(135deg, #ecfdf5 0%, #eff6ff 100%);
            --cta-gradient: linear-gradient(135deg, #059669 0%, #2563EB 100%);
            --text-gray: #6B7280;
            --border: #E5E7EB;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { color: var(--dark); background-color: #F9FAFB; line-height: 1.6; }

        /* --- UTILITIES --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 5%; }
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s ease; width: auto; font-size: 0.95rem; text-decoration: none; gap: 0.5rem; }
        .btn-primary { background: var(--primary); color: var(--white); box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.3); }
        .btn-primary:hover { background: var(--primary-hover); transform: translateY(-1px); }
        .btn-outline { background: white; border: 1px solid #e5e7eb; color: var(--dark); }
        .btn-outline:hover { background: #f9fafb; border-color: #d1d5db; }
        .btn-sm { padding: 0.4rem 1rem; font-size: 0.85rem; }
        .btn-white { background: white; color: var(--secondary); font-weight: 700; border-radius: 50px; }
        .btn-white:hover { background: #f9fafb; transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .btn-full { width: 100%; }
        
        .hidden { display: none; }

        /* --- NAVBAR --- */
        .navbar { padding: 1.2rem 0; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); box-shadow: 0 1px 3px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 800; display: flex; align-items: center; gap: 0.5rem; cursor: pointer; }
        .logo span { color: var(--primary); }
        .nav-links { display: flex; gap: 1.5rem; align-items: center; }
        .nav-links a { text-decoration: none; color: var(--dark); font-weight: 500; transition: color 0.2s; font-size: 0.95rem; cursor: pointer; }
        .nav-links a:hover, .nav-links a.active { color: var(--primary); }

        /* Points Badge in Nav */
        .points-badge { background: #FEF3C7; color: #D97706; padding: 0.4rem 0.8rem; border-radius: 50px; font-weight: 700; font-size: 0.9rem; display: flex; align-items: center; gap: 5px; border: 1px solid #FCD34D; cursor: pointer; transition: transform 0.2s; }
        .points-badge:hover { transform: scale(1.05); background: #FDE68A; }

        /* --- REWARD POPUP STYLES --- */
        .reward-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px); opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        .reward-overlay.show { opacity: 1; pointer-events: all; }
        .reward-card { background: white; padding: 2.5rem; border-radius: 20px; text-align: center; max-width: 400px; transform: scale(0.8); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); position: relative; overflow: hidden; }
        .reward-overlay.show .reward-card { transform: scale(1); }
        .reward-icon { font-size: 4rem; margin-bottom: 1rem; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-20px);} 60% {transform: translateY(-10px);} }

        /* --- SECTION VISIBILITY --- */
        section { display: none !important; }
        section.active { display: block !important; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- HERO & CAMERA STYLES --- */
        .hero { background: var(--gradient); min-height: 90vh; padding-top: 3rem; display: flex; flex-direction: column; }
        .hero-layout { display: flex; align-items: center; justify-content: space-between; gap: 3rem; width: 100%; padding-bottom: 4rem; }
        .hero-text { flex: 1; }
        .hero h1 { font-size: 3.5rem; line-height: 1.1; margin-bottom: 1.5rem; letter-spacing: -1px; }
        
        .hero-card { flex: 1; background: var(--white); padding: 1.5rem; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); max-width: 500px; text-align: center; border: 1px solid rgba(0,0,0,0.05); }
        .camera-wrapper { position: relative; width: 100%; height: 320px; background: #000; border-radius: 16px; overflow: hidden; margin-bottom: 1rem; box-shadow: inset 0 0 20px rgba(0,0,0,0.2); }
        video, canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        canvas { z-index: 10; }
        .camera-placeholder { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; z-index: 20; background: #111; }
        
        .scan-line { position: absolute; width: 100%; height: 4px; background: var(--primary); top: 0; z-index: 15; box-shadow: 0 0 10px var(--primary); animation: scan 2s linear infinite; display: none; }
        @keyframes scan { 0% { top: 0%; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { top: 100%; opacity: 0; } }

        /* --- IMPACT GRID --- */
        .impact-dashboard { margin-top: 1rem; text-align: left; }
        .impact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .impact-item { background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 15px; display: flex; flex-direction: column; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .impact-icon { font-size: 1.5rem; margin-bottom: 5px; }
        .impact-val { font-size: 1.2rem; font-weight: 800; line-height: 1.2; }
        .impact-unit { font-size: 0.75rem; color: #666; font-weight: 500; }
        .color-co2 { color: #10B981; } .color-tree { color: #059669; } .color-energy { color: #F59E0B; } .color-water { color: #2563EB; }

        /* --- CTA SECTION --- */
        .cta-section { background: var(--cta-gradient); color: white; padding: 6rem 0 0 0; text-align: center; width: 100%; position: relative; overflow: hidden; }
        .cta-content { max-width: 1200px; margin: 0 auto; padding: 0 5%; position: relative; z-index: 2; }
        .cta-header h2 { font-size: 3rem; font-weight: 800; margin-bottom: 1rem; letter-spacing: -1px; }
        .cta-header p { font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto 3rem auto; }
        
        .glass-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem; margin-bottom: 4rem; }
        .glass-card { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.2); border-radius: 20px; padding: 2rem; text-align: left; transition: transform 0.3s; cursor: pointer; }
        .glass-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.15); }
        .glass-icon { font-size: 2rem; margin-bottom: 1rem; display: inline-block; }
        .glass-card h3 { font-size: 1.2rem; margin-bottom: 0.5rem; font-weight: 700; }
        
        .cta-stats-bar { background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(20px); padding: 3rem 0; margin-top: 5rem; display: flex; justify-content: space-around; flex-wrap: wrap; gap: 2rem; border-top: 1px solid rgba(255,255,255,0.1); }
        .cta-stat h3 { font-size: 2.5rem; font-weight: 800; margin-bottom: 0.25rem; font-family: monospace; }
        .cta-stat p { font-size: 0.9rem; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }

        /* --- REWARDS STORE STYLES --- */
        .coupon-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; }
        .coupon-card { background: white; border: 1px solid var(--border); border-radius: 16px; padding: 0; overflow: hidden; transition: transform 0.2s; display: flex; flex-direction: column; }
        .coupon-card:hover { transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .coupon-img { height: 120px; background: #f3f4f6; display: flex; align-items: center; justify-content: center; font-size: 3rem; border-bottom: 1px solid #eee; }
        .coupon-content { padding: 1.5rem; flex: 1; display: flex; flex-direction: column; }
        .coupon-cost { font-weight: 800; color: #D97706; margin-bottom: 0.5rem; display: block; }
        .coupon-code { background: #F3F4F6; border: 2px dashed #D1D5DB; padding: 0.5rem; text-align: center; margin-top: 1rem; font-family: monospace; font-weight: 700; letter-spacing: 1px; display: none; }
        .coupon-code.revealed { display: block; background: #ECFDF5; border-color: #10B981; color: #065F46; }

        /* --- COMMUNITY STYLES --- */
        .comm-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; }
        .post-card { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; }
        .post-header { display: flex; align-items: center; gap: 10px; margin-bottom: 0.5rem; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: #E5E7EB; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; font-weight: 700; }
        .event-card { background: var(--primary); color: white; border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; }
        
        .social-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 1rem; }
        .social-btn { display: flex; flex-direction: column; align-items: center; justify-content: center; background: white; border: 1px solid #eee; border-radius: 12px; padding: 1rem; cursor: pointer; transition: all 0.2s; color: var(--dark); text-decoration: none; }
        .social-btn:hover { background: #f9fafb; transform: translateY(-2px); border-color: var(--primary); }
        .social-icon { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .discord-color { color: #5865F2; } .insta-color { color: #E1306C; } .wa-color { color: #25D366; }

        /* --- CALCULATOR --- */
        .calc-header { text-align: center; margin-bottom: 3rem; }
        .calc-header h2 { font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem; letter-spacing: -1px; }
        .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; max-width: 1000px; margin: 0 auto; }
        .calc-card { background: white; border: 1px solid var(--border); border-radius: 16px; padding: 2.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .result-empty { text-align: center; color: var(--text-gray); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; }
        .result-filled { display: none; animation: fadeIn 0.5s ease; }
        .res-row { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; border-bottom: 1px solid #f3f4f6; }
        
        /* --- WIZARD --- */
        .stepper { display: flex; justify-content: center; align-items: center; margin-bottom: 3rem; gap: 1rem; position: relative; max-width: 800px; margin: 0 auto; }
        .step { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; position: relative; z-index: 2; width: 80px; }
        .step-circle { width: 40px; height: 40px; border-radius: 50%; background: white; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; color: var(--text-gray); transition: all 0.3s; }
        .step.active .step-circle { border-color: var(--primary); color: var(--primary); background: #ecfdf5; }
        .step.completed .step-circle { background: var(--primary); color: white; border-color: var(--primary); }
        .stepper::before { content: ''; position: absolute; top: 20px; left: 50px; right: 50px; height: 2px; background: var(--border); z-index: 1; }
        
        .wizard-card { background: white; border: 1px solid var(--border); border-radius: 16px; padding: 2rem; max-width: 900px; margin: 0 auto; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05); }
        .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; }
        .category-option { border: 2px solid var(--border); border-radius: 12px; padding: 1.5rem 1rem; text-align: center; cursor: pointer; transition: all 0.2s; }
        .category-option:hover { border-color: var(--primary); background: #f0fdf4; transform: translateY(-2px); }
        .category-option.selected { border-color: var(--primary); background: #ecfdf5; }
        .cat-icon { font-size: 2rem; margin-bottom: 0.5rem; display: block; }
        
        .upload-area { border: 2px dashed var(--border); border-radius: 12px; padding: 3rem; text-align: center; cursor: pointer; background: #fafafa; }
        .preview-container { margin-top: 1rem; display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; }
        .preview-img { width: 100%; height: 100px; object-fit: cover; border-radius: 8px; border: 1px solid var(--border); }

        /* --- DASHBOARD --- */
        .dashboard-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem; }
        .dashboard-title h2 { font-size: 2.2rem; margin-bottom: 0.5rem; font-weight: 800; letter-spacing: -1px; }
        .live-panel { background: white; border: 1px solid #e5e7eb; border-radius: 16px; padding: 1.5rem; margin-bottom: 2rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        .live-stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; }
        .live-stat h4 { color: #6B7280; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .live-stat .value { font-size: 1.8rem; font-weight: 800; color: var(--dark); font-family: monospace; }
        .live-stat .value.green { color: var(--primary); }
        .live-stat .value.orange { color: #F97316; }
        .main-stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.5rem; }
        .stat-card-new { background: white; border: 1px solid #e5e7eb; border-radius: 16px; padding: 1.5rem; position: relative; transition: transform 0.2s; }
        .stat-card-new:hover { transform: translateY(-3px); }
        .card-icon { width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; margin-bottom: 1.5rem; }
        .icon-device { color: #10B981; border: 1px solid #10B981; }
        .icon-leaf { color: #059669; border: 1px solid #059669; }
        .icon-users { color: #3B82F6; border: 1px solid #3B82F6; }
        .icon-loc { color: #F59E0B; border: 1px solid #F59E0B; }
        .trend { position: absolute; top: 1.5rem; right: 1.5rem; font-size: 0.85rem; font-weight: 600; color: #10B981; background: #ecfdf5; padding: 2px 8px; border-radius: 50px; }
        .big-num { font-size: 2rem; font-weight: 800; margin-bottom: 0.25rem; }

        /* --- SOLUTIONS MAP STYLES --- */
        .solutions-header { text-align: center; margin-bottom: 3rem; }
        .solutions-header p { max-width: 600px; margin: 0 auto; color: var(--text-gray); }
        .solutions-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 3rem; }
        .s-stat-card { background: white; padding: 1.5rem; border-radius: 12px; border: 1px solid #e5e7eb; display: flex; flex-direction: column; gap: 0.5rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .solutions-layout { display: grid; grid-template-columns: 280px 1fr; gap: 2rem; }
        
        .s-sidebar { background: white; border-radius: 16px; padding: 1.5rem; border: 1px solid #e5e7eb; height: fit-content; }
        .s-input { width: 100%; padding: 0.6rem 0.8rem; border: 1px solid #d1d5db; border-radius: 8px; margin-bottom: 1rem; }
        .s-card { background: white; border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden; transition: all 0.2s; display: flex; flex-direction: column; margin-bottom: 1.5rem; }
        .s-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1); border-color: var(--primary); }
        .s-img-container { height: 160px; background: #f3f4f6; position: relative; display: flex; align-items: center; justify-content: center; color: #9ca3af; font-size: 3rem; border-bottom: 1px solid #eee; }
        .s-badge-container { position: absolute; top: 10px; right: 10px; display: flex; gap: 5px; }
        .s-badge { font-size: 0.7rem; padding: 4px 8px; border-radius: 4px; font-weight: 600; background: rgba(0,0,0,0.6); color: white; backdrop-filter: blur(2px); }
        .s-badge.verified { background: var(--primary); }
        .s-card-content { padding: 1.25rem; flex: 1; display: flex; flex-direction: column; }
        .s-meta { font-size: 0.85rem; color: #6B7280; margin-bottom: 1rem; }
        .s-actions { margin-top: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        /* Form Inputs */
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--dark); }
        .form-input, .form-select { width: 100%; padding: 0.75rem 1rem; border: 1px solid var(--border); border-radius: 8px; font-size: 1rem; transition: border 0.2s; background: white; }
        .form-input:focus, .form-select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1); }

        @media (max-width: 900px) {
            .solutions-layout, .calc-grid, .comm-grid { grid-template-columns: 1fr; }
            .hero-layout { flex-direction: column; text-align: center; }
            .hero-text { padding-bottom: 0; }
            .impact-dashboard { text-align: left; }
        }
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .cta-stats-bar { flex-direction: column; gap: 2rem; }
        }
    </style>
</head>
<body>

    <div class="reward-overlay" id="daily-reward-popup">
        <div class="reward-card">
            <div class="reward-icon">üéÅ</div>
            <h2 style="font-size:1.8rem; margin-bottom:0.5rem; color:#10B981;">Daily Bonus!</h2>
            <p style="color:#6B7280; margin-bottom:1.5rem;">Thanks for visiting EcoCircuit today. You've earned free Green Points!</p>
            <div style="font-size:2.5rem; font-weight:800; color:#F59E0B; margin-bottom:1.5rem;">+50 PTS</div>
            <button class="btn btn-primary btn-full" onclick="claimReward()">Collect Reward</button>
        </div>
    </div>

    <nav class="navbar">
        <div class="container nav-content">
            <div class="logo" onclick="navigate(event, 'home')">
                ‚ôªÔ∏è Eco<span>Circuit</span>
            </div>
            <div class="nav-links">
                <a href="#" onclick="navigate(event, 'solutions')" id="nav-solutions">Solutions Map</a>
                <a href="#" onclick="navigate(event, 'community')" id="nav-community">Community</a>
                <a href="#" onclick="navigate(event, 'rewards')" id="nav-rewards">Rewards</a>
                <a href="#" onclick="navigate(event, 'impact')" id="nav-impact">Dashboard</a>
                <a href="#" onclick="navigate(event, 'submit-waste')">Submit</a>
                <div class="points-badge" id="nav-points" onclick="navigate(event, 'rewards')">üèÜ 0 Pts</div>
            </div>
            <button class="btn btn-outline btn-sm" onclick="navigate(event, 'home'); setTimeout(startCamera, 500); window.scrollTo(0,0);">üì∑ Scan Item</button>
        </div>
    </nav>

    <section id="home" class="hero active">
        <div class="container hero-layout">
            <div class="hero-text">
                <h1>Classify E-Waste with <span style="color:var(--primary)">AI</span></h1>
                <p style="font-size: 1.1rem; color: #4B5563; margin-bottom: 2rem;">Instantly detect ICT devices, electronics, and appliances. Determine recyclability and carbon impact in real-time.</p>
                <div>
                    <button class="btn btn-primary" onclick="startCamera()">Start AI Scanner</button>
                    <button class="btn btn-outline" onclick="navigate(event, 'submit-waste')" style="margin-left: 10px;">Manual Upload</button>
                </div>
            </div>
            
            <div class="hero-card">
                <div style="display:flex; justify-content:space-between; margin-bottom:0.5rem;">
                    <h3>Live Detection</h3>
                    <span style="background:#e5e7eb; padding:2px 8px; border-radius:4px; font-size:0.75rem; display:flex; align-items:center;" id="model-status">‚åõ Loading Model...</span>
                </div>
                <div class="camera-wrapper">
                    <div class="scan-line" id="scan-line"></div>
                    <div class="camera-placeholder" id="placeholder">
                        <div style="font-size: 3rem; margin-bottom:1rem;">üì∑</div>
                        <p>Click "Start AI Scanner"</p>
                        <p style="font-size:0.8rem; opacity:0.7;">Requires Camera Permissions</p>
                    </div>
                    <video id="webcam" autoplay playsinline muted></video>
                    <canvas id="canvas"></canvas>
                </div>
                <div class="impact-dashboard">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <span class="impact-title">Detected: <span id="item-name" style="color:var(--primary); font-weight:800; font-size:1.1rem;">Waiting...</span></span>
                    </div>
                    <div class="impact-grid">
                        <div class="impact-item"><div class="impact-icon">üçÉ</div><div class="impact-val color-co2" id="val-co2">--</div><div class="impact-unit">kg CO‚ÇÇ Avoided</div></div>
                        <div class="impact-item"><div class="impact-icon">‚ö°</div><div class="impact-val color-energy" id="val-energy">--</div><div class="impact-unit">kWh Saved</div></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="cta-section">
            <div class="cta-content">
                <div class="cta-header">
                    <h2>Ready to Make a Difference?</h2>
                    <p>Join the EcoCircuit community.</p>
                </div>
                <div class="glass-grid">
                    <div class="glass-card" onclick="navigate(event, 'submit-waste')" style="cursor:pointer;"><div class="glass-icon">üì§</div><h3>Submit Devices</h3><p>Quick and easy device submission.</p></div>
                    <div class="glass-card" onclick="navigate(event, 'impact')" style="cursor:pointer;"><div class="glass-icon">üìä</div><h3>Track Impact</h3><p>Real-time dashboard visualization.</p></div>
                    <div class="glass-card" onclick="navigate(event, 'rewards')" style="cursor:pointer;"><div class="glass-icon">üéÅ</div><h3>Daily Rewards</h3><p>Earn coupons for every visit!</p></div>
                    <div class="glass-card" onclick="navigate(event, 'community')" style="cursor:pointer;"><div class="glass-icon">ü§ù</div><h3>Community</h3><p>Join forums and local drives.</p></div>
                </div>
            </div>
            <div class="cta-stats-bar">
                <div class="cta-stat"><h3>62M</h3><p>Tonnes Generated (2024)</p></div>
                <div class="cta-stat"><h3>22.3%</h3><p>Recycling Rate</p></div>
                <div class="cta-stat"><h3>$91B</h3><p>Value of Materials</p></div>
            </div>
        </div>
        
        <footer class="site-footer">
            <div class="footer-grid">
                <div class="footer-col"><h4>Platform</h4><ul><li><a href="#" onclick="navigate(event, 'submit-waste')">Submit Waste</a></li><li><a href="#" onclick="navigate(event, 'impact')">Live Dashboard</a></li></ul></div>
                <div class="footer-col"><h4>Resources</h4><ul><li><a href="#">Recycling Guide</a></li><li><a href="#">Facility Map</a></li></ul></div>
                <div class="footer-col"><h4>Contact</h4><ul><li><a href="#">support@ecocircuit.in</a></li><li><a href="#">Gwalior, MP, India</a></li></ul></div>
            </div>
            <div style="text-align: center; margin-top: 3rem; color: #9CA3AF; font-size: 0.8rem;">¬© 2026 EcoCircuit. Built for Hack2Skill.</div>
        </footer>
    </section>

    <section id="rewards" class="container" style="padding: 4rem 0;">
        <div class="calc-header">
            <span style="color:#F59E0B; font-weight:600; font-size:0.9rem;">üéÅ Rewards Store</span>
            <h2>Redeem Your Green Points</h2>
            <p style="color:var(--text-gray);">Use points earned from daily visits and recycling to get exclusive coupons.</p>
        </div>
        <div style="background:#FEF3C7; padding:1.5rem; border-radius:16px; margin-bottom:3rem; text-align:center; border:1px solid #FCD34D;">
            <span style="font-weight:700; color:#B45309; font-size:1.1rem;">Your Balance:</span> 
            <span id="store-points" style="font-weight:800; font-size:2rem; color:#D97706; margin: 0 10px;">0</span> 
            <span style="font-weight:700; color:#B45309; font-size:1.1rem;">Points</span>
        </div>
        
        <div class="coupon-grid">
            <div class="coupon-card">
                <div class="coupon-img">üõí</div>
                <div class="coupon-content">
                    <h3>Amazon ‚Çπ100 Voucher</h3>
                    <p style="font-size:0.9rem; color:#666; margin-bottom:1rem;">Get ‚Çπ100 off on your next eco-friendly purchase.</p>
                    <span class="coupon-cost">500 Pts</span>
                    <button class="btn btn-primary btn-full" onclick="redeemCoupon(500, this)">Redeem</button>
                    <div class="coupon-code">AMZ-ECO-2026</div>
                </div>
            </div>
            <div class="coupon-card">
                <div class="coupon-img">üçî</div>
                <div class="coupon-content">
                    <h3>Swiggy 20% Off</h3>
                    <p style="font-size:0.9rem; color:#666; margin-bottom:1rem;">Discount on healthy food orders above ‚Çπ200.</p>
                    <span class="coupon-cost">300 Pts</span>
                    <button class="btn btn-primary btn-full" onclick="redeemCoupon(300, this)">Redeem</button>
                    <div class="coupon-code">SWIGGY-GREEN</div>
                </div>
            </div>
            <div class="coupon-card">
                <div class="coupon-img">üéß</div>
                <div class="coupon-content">
                    <h3>Boat 15% Off</h3>
                    <p style="font-size:0.9rem; color:#666; margin-bottom:1rem;">Discount on refurbished electronics.</p>
                    <span class="coupon-cost">800 Pts</span>
                    <button class="btn btn-primary btn-full" onclick="redeemCoupon(800, this)">Redeem</button>
                    <div class="coupon-code">BOAT-RENEW</div>
                </div>
            </div>
             <div class="coupon-card">
                <div class="coupon-img">‚òï</div>
                <div class="coupon-content">
                    <h3>Starbucks Free Coffee</h3>
                    <p style="font-size:0.9rem; color:#666; margin-bottom:1rem;">Get a free tall latte when you bring your own cup.</p>
                    <span class="coupon-cost">1000 Pts</span>
                    <button class="btn btn-primary btn-full" onclick="redeemCoupon(1000, this)">Redeem</button>
                    <div class="coupon-code">STAR-BYOC-26</div>
                </div>
            </div>
        </div>
    </section>

    <section id="community" class="container" style="padding: 4rem 0;">
        <div class="calc-header">
            <span style="color:#3B82F6; font-weight:600; font-size:0.9rem;">ü§ù Community Hub</span>
            <h2>Connect & Collaborate</h2>
            <p style="color:var(--text-gray);">Join local drives, discuss e-waste solutions, and climb the leaderboard.</p>
        </div>

        <div class="comm-grid">
            <div class="comm-main">
                <h3 style="margin-bottom:1.5rem;">Discussion Forum</h3>
                <div class="post-card">
                    <div class="post-header">
                        <div class="avatar" style="background:#e0f2fe; color:#0369a1;">TG</div>
                        <div>
                            <div style="font-weight:700;">Tanmay Goyal</div>
                            <div style="font-size:0.8rem; color:#666;">1 hours ago ‚Ä¢ Gwalior</div>
                        </div>
                    </div>
                    <p>Has anyone used the new pickup service from Prometheus Recycling? Is it really free for bulk items like washing machines?</p>
                    <div style="margin-top:1rem; display:flex; gap:1rem; font-size:0.9rem; color:#666;">
                        <span style="cursor:pointer;" onclick="alert('Comments coming soon!')">üí¨ 4 Comments</span> 
                        <span style="cursor:pointer;" onclick="this.innerHTML='‚ù§Ô∏è 13 Likes'; this.style.color='red';">‚ù§Ô∏è 12 Likes</span>
                    </div>
                </div>
                <div class="post-card">
                    <div class="post-header">
                        <div class="avatar" style="background:#fce7f3; color:#be185d;">DB</div>
                        <div>
                            <div style="font-weight:700;">Daksh Bansal</div>
                            <div style="font-size:0.8rem; color:#666;">2 hours ago ‚Ä¢ Gwalior</div>
                        </div>
                    </div>
                    <p>Just dropped off my old laptop at the Kabad Factory center. They gave me a certificate of recycling instantly! Highly recommend.</p>
                    <div style="margin-top:1rem; display:flex; gap:1rem; font-size:0.9rem; color:#666;">
                        <span style="cursor:pointer;" onclick="alert('Comments coming soon!')">üí¨ 2 Comments</span> 
                        <span style="cursor:pointer;" onclick="this.innerHTML='‚ù§Ô∏è 9 Likes'; this.style.color='red';">‚ù§Ô∏è 8 Likes</span>
                    </div>
                </div>
            </div>

            <div class="comm-sidebar">
                <h3 style="margin-bottom:1.5rem;">Social Connect</h3>
                <div class="social-grid">
                    <a href="https://discord.com" target="_blank" class="social-btn discord-color">
                        <i class="fab fa-discord social-icon"></i>
                        <span style="font-size:0.8rem; font-weight:600;">Discord</span>
                    </a>
                    <a href="https://instagram.com" target="_blank" class="social-btn insta-color">
                        <i class="fab fa-instagram social-icon"></i>
                        <span style="font-size:0.8rem; font-weight:600;">Instagram</span>
                    </a>
                    <a href="https://whatsapp.com" target="_blank" class="social-btn wa-color">
                        <i class="fab fa-whatsapp social-icon"></i>
                        <span style="font-size:0.8rem; font-weight:600;">WhatsApp</span>
                    </a>
                </div>

                <h3 style="margin: 1.5rem 0;">Upcoming Drives</h3>
                <div class="event-card">
                    <div style="font-size:0.8rem; opacity:0.9; margin-bottom:0.5rem; font-weight:700;">FEB 15 ‚Ä¢ GWALIOR</div>
                    <h4 style="font-size:1.1rem; margin-bottom:0.5rem;">City Center E-Drive</h4>
                    <p style="font-size:0.9rem; opacity:0.9; margin-bottom:1rem;">Bulk collection drive at City Center Mall. Bring your old batteries.</p>
                    <button class="btn btn-sm btn-white" style="color:var(--primary);" onclick="this.innerText='‚úÖ Registered'; this.disabled=true;">I'm Going</button>
                </div>

                <div style="background:white; border:1px solid #eee; padding:1.5rem; border-radius:12px;">
                    <h4 style="margin-bottom:1rem;">Top Contributors</h4>
                    <div style="display:flex; justify-content:space-between; margin-bottom:0.8rem; font-size:0.9rem;">
                        <span>1. Tanmay Goyal</span> <span style="font-weight:700; color:#10B981;">1000 pts</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:0.8rem; font-size:0.9rem;">
                        <span>2. Tanya Gupta</span> <span style="font-weight:700; color:#10B981;">980 pts</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:0.8rem; font-size:0.9rem;">
                        <span>3. Ayushi Choudhary</span> <span style="font-weight:700; color:#10B981;">860 pts</span> 
    
                    </div>
                   <div style="display:flex; justify-content:space-between; font-size:0.9rem;">
                        <span>4. Daksh Bansal</span> <span style="font-weight:700; color:#10B981;">850 pts</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="calculator" class="container" style="padding: 4rem 0;">
        <div class="calc-header">
            <span style="color:#F59E0B; font-weight:600; font-size:0.9rem;">üßÆ Impact Calculator</span>
            <h2>Calculate Your Contribution</h2>
            <p style="color:var(--text-gray);">Estimate the environmental impact of recycling your specific devices.</p>
        </div>
        <div class="calc-grid">
            <div class="calc-card">
                <h3 style="margin-bottom:1.5rem; font-size:1.25rem;">Enter Device Details</h3>
                <div class="form-group">
                    <label class="form-label">Device Type <span style="color:red">*</span></label>
                    <select class="form-select" id="calc-device"></select>
                </div>
                <div class="form-group">
                    <label class="form-label">Quantity <span style="color:red">*</span></label>
                    <input type="number" class="form-input" id="calc-qty" value="1" min="1">
                </div>
                <button class="btn btn-primary btn-full" onclick="calculateImpact()">Calculate Impact</button>
                <button class="btn btn-outline btn-full" style="margin-top:10px;" onclick="resetCalculator()">Reset</button>
            </div>
            <div class="calc-card">
                <div id="calc-empty" class="result-empty">
                    <div style="font-size:4rem; margin-bottom:1rem; opacity:0.3;">üçÉ</div>
                    <h3>Impact Results</h3>
                    <p>Select a device to see your savings.</p>
                </div>
                <div id="calc-filled" class="result-filled">
                    <h3 style="margin-bottom:1.5rem; text-align:center;">Estimated Savings</h3>
                    <div class="res-row"><div class="res-label">üçÉ CO‚ÇÇ Emissions</div><div class="res-val" id="res-co2">0 kg</div></div>
                    <div class="res-row"><div class="res-label">üå≥ Trees Equivalent</div><div class="res-val" id="res-tree">0</div></div>
                    <div class="res-row"><div class="res-label">‚ö° Energy Saved</div><div class="res-val" id="res-energy">0 kWh</div></div>
                    <div class="res-row"><div class="res-label">üíß Water Saved</div><div class="res-val" id="res-water">0 L</div></div>
                    <button class="btn btn-primary btn-full" style="margin-top:2rem;" onclick="navigate(event, 'submit-waste')">Recycle This Item Now</button>
                </div>
            </div>
        </div>
    </section>

    <section id="submit-waste" class="container" style="padding: 4rem 0;">
        <div class="calc-header">
            <h2>Submit E-Waste Request</h2>
            <p>Schedule a pickup from your home in Gwalior.</p>
        </div>
        <div class="stepper">
            <div class="step active" id="step-indicator-1"><div class="step-circle">1</div><span style="font-size:0.8rem; margin-top:5px;">Category</span></div>
            <div class="step" id="step-indicator-2"><div class="step-circle">2</div><span style="font-size:0.8rem; margin-top:5px;">Details</span></div>
            <div class="step" id="step-indicator-3"><div class="step-circle">3</div><span style="font-size:0.8rem; margin-top:5px;">Address</span></div>
            <div class="step" id="step-indicator-4"><div class="step-circle">4</div><span style="font-size:0.8rem; margin-top:5px;">Done</span></div>
        </div>
        <div class="wizard-card">
            <div id="step-content-1">
                <div class="category-grid">
                    <div class="category-option" onclick="selectCategory(this, 'ICT')"><span class="cat-icon">üíª</span><span class="cat-name">Computers/Laptops</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'Mobile')"><span class="cat-icon">üì±</span><span class="cat-name">Mobile/Tablets</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'Consumer')"><span class="cat-icon">üì∫</span><span class="cat-name">TVs/Monitors</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'LargeApp')"><span class="cat-icon">‚ùÑÔ∏è</span><span class="cat-name">Large Appliances</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'SmallApp')"><span class="cat-icon">üçû</span><span class="cat-name">Small Appliances</span></div>
                </div>
            </div>
            <div id="step-content-2" class="hidden">
                <div class="form-group"><label class="form-label">Item Description</label><input type="text" class="form-input" placeholder="e.g. Dell Inspiron 15, Broken Screen"></div>
                <div class="form-group"><label class="form-label">Condition</label><select class="form-select"><option>Working</option><option>Repairable</option><option>Scrap/Broken</option></select></div>
                <div class="upload-area" onclick="document.getElementById('file-input').click()">
                    <div style="font-size:2rem;">üì∑</div><p>Upload Photos (Optional)</p>
                    <input type="file" id="file-input" multiple accept="image/*" style="display:none;" onchange="handleFiles(this.files)">
                </div>
                <div class="preview-container" id="gallery"></div>
            </div>
            <div id="step-content-3" class="hidden">
                <div class="form-group"><label class="form-label">Pickup Address</label><input type="text" class="form-input" value="Institute of Technology & Management, Gwalior"></div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:1rem;">
                    <div class="form-group"><label class="form-label">City</label><input type="text" class="form-input" value="Gwalior"></div>
                    <div class="form-group"><label class="form-label">ZIP</label><input type="text" class="form-input" value="474001"></div>
                </div>
                <div class="form-group"><label class="form-label">Contact Number</label><input type="text" class="form-input" placeholder="+91"></div>
            </div>
            <div id="step-content-4" class="hidden">
                <div style="text-align:center; padding: 2rem 0;">
                    <div style="font-size:4rem; margin-bottom:1rem;">‚úÖ</div>
                    <h3>Request Submitted Successfully!</h3>
                    <p>Your pickup ID is <b id="pickup-id">#EC-2026-889</b></p>
                    <div style="background:#ECFDF5; padding:1rem; border-radius:12px; margin-top:2rem; border:1px solid #10B981; color:#065F46;">
                        <h4 style="margin:0; font-size:1.2rem;">üéâ You Earned 100 Points!</h4>
                        <p style="margin:0; font-size:0.9rem;">Check your wallet in the Rewards section.</p>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 2rem; display: flex; justify-content: space-between; border-top:1px solid #eee; padding-top:1rem;">
                <button class="btn btn-outline" id="prev-btn" onclick="changeStep(-1)" style="display:none;">Back</button>
                <button class="btn btn-primary" id="next-btn" style="margin-left:auto;" onclick="changeStep(1)">Continue</button>
            </div>
        </div>
    </section>

    <section id="solutions" class="container" style="padding: 3rem 0;">
        <div class="solutions-header">
            <span style="color:#10B981; font-weight:600; font-size:0.9rem;">üìç Find Recycling Solutions</span>
            <h2 style="font-size: 2.5rem; margin: 0.5rem 0 1rem 0;">All India Recycling Network</h2>
            <p>Authorized e-waste recyclers across Madhya Pradesh, Delhi, Maharashtra, and Karnataka.</p>
        </div>

        <div class="solutions-layout">
            <aside class="s-sidebar">
                <div style="margin-bottom:1.5rem; font-weight:700;">Filter Locations</div>
                
                <div style="margin-bottom:1rem;">
                    <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">State</label>
                    <select class="s-input" id="state-filter" onchange="filterSolutions()">
                        <option value="">All States</option>
                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                        <option value="Delhi">Delhi NCR</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Telangana">Telangana</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                    </select>
                </div>

                <div style="margin-bottom:1rem;">
                    <label style="display:block; margin-bottom:0.5rem; font-size:0.9rem;">Search City/Area</label>
                    <input type="text" class="s-input" id="search-input" placeholder="e.g. Gwalior, Mumbai..." onkeyup="filterSolutions()">
                </div>

                <div style="margin-bottom:1rem;">
                     <label style="display:flex; gap:0.5rem; font-size:0.9rem; align-items:center;"><input type="checkbox" checked> Verified Partners</label>
                </div>
            </aside>

            <div class="s-main">
                <div id="solutions-list">
                    </div>
            </div>
        </div>
    </section>

    <section id="impact" class="container" style="padding: 4rem 0;">
        <div class="dashboard-header">
            <div class="dashboard-title">
                <h2>Hello, Tanmay üëã</h2>
                <p>Real-time Global E-Waste Statistics (Source: GEM 2024)</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-outline" onclick="alert('Exporting PDF Report...')">‚Üì Export Report</button>
                <button class="btn btn-primary" onclick="alert('Link copied to clipboard!')">Share Impact</button>
            </div>
        </div>
        
        <div class="live-panel">
            <div style="display:flex; align-items:center; gap:0.5rem; color:#EF4444; margin-bottom:1.5rem; font-weight:700;">
                <div style="width:10px; height:10px; background:#EF4444; border-radius:50%; animation:pulse 1s infinite;"></div> LIVE: Global Generation
            </div>
            <div class="live-stats-row">
                <div class="live-stat"><h4>E-Waste Generated (This Year)</h4><div class="value" id="global-waste-kg">0</div><div style="font-size:0.8rem; color:#666;">kg</div></div>
                <div class="live-stat"><h4>E-Waste Generated (Today)</h4><div class="value orange" id="today-waste-kg">0</div><div style="font-size:0.8rem; color:#666;">kg</div></div>
                <div class="live-stat"><h4>Recycled Formally (22.3%)</h4><div class="value green" id="recycled-waste-kg">0</div><div style="font-size:0.8rem; color:#666;">kg</div></div>
            </div>
            <p style="margin-top:1rem; font-size:0.8rem; color:#999;">*Estimates based on 62 Billion kg annual generation (1,966 kg/sec).</p>
        </div>

        <div class="main-stats-grid">
            <div class="stat-card-new"><div class="trend">‚Üó +12%</div><div class="card-icon icon-device">üì±</div><h3>Your Submissions</h3><div class="big-num">12</div><span class="unit">devices</span></div>
            <div class="stat-card-new"><div class="trend">‚Üó +8%</div><div class="card-icon icon-leaf">üçÉ</div><h3>CO‚ÇÇ Saved</h3><div class="big-num">48.5</div><span class="unit">kg</span></div>
            <div class="stat-card-new"><div class="card-icon icon-users">üë•</div><h3>Community Rank</h3><div class="big-num">#42</div><span class="unit">in Gwalior</span></div>
        </div>
    </section>

    <script>
        // --- 1. CONFIGURATION & DATABASE ---
        // EXPANDED All-India Database
        const facilitiesDB = [
            // Madhya Pradesh (Gwalior, Indore, Bhopal)
            { name: "Prometheus Recycling Pvt Ltd", state: "Madhya Pradesh", city: "Gwalior", address: "Plot No. 786/4, Susera, Gwalior, MP", type: "Authorized Recycler", rating: 4.8, icon: "üè≠", verified: true },
            { name: "Kabad Factory", state: "Madhya Pradesh", city: "Gwalior", address: "Chambal Colony, Thatipur, Gwalior, MP", type: "Collection Center", rating: 4.9, icon: "‚ôªÔ∏è", verified: true },
            { name: "Unique Eco Recycle", state: "Madhya Pradesh", city: "Gwalior", address: "Transport Nagar, Gwalior, MP", type: "Regional Recycler", rating: 4.6, icon: "üöõ", verified: true },
            { name: "MP E-Waste Solutions", state: "Madhya Pradesh", city: "Indore", address: "Sanwer Road, Industrial Area, Indore, MP", type: "Processing Plant", rating: 4.7, icon: "üè≠", verified: true },
            { name: "Bhopal Green Recyclers", state: "Madhya Pradesh", city: "Bhopal", address: "Govindpura Industrial Area, Bhopal, MP", type: "Authorized Recycler", rating: 4.5, icon: "‚ôªÔ∏è", verified: true },

            // Delhi NCR
            { name: "Attero Recycling Pvt Ltd", state: "Delhi", city: "Noida", address: "H-59, Sector 63, Noida, UP", type: "India's Largest Recycler", rating: 4.9, icon: "üè≠", verified: true },
            { name: "Karo Sambhav", state: "Delhi", city: "New Delhi", address: "408, 4th Floor, New Delhi House, Barakhamba Rd", type: "PRO / Collection", rating: 4.8, icon: "ü§ù", verified: true },
            { name: "Chintan Environmental", state: "Delhi", city: "New Delhi", address: "C-14, 2nd Floor, Lajpat Nagar III, New Delhi", type: "NGO / Collection", rating: 4.6, icon: "üå±", verified: true },

            // Maharashtra (Mumbai, Pune)
            { name: "Eco Recycling Ltd (Ecoreco)", state: "Maharashtra", city: "Mumbai", address: "422, The Summit Business Bay, Andheri East, Mumbai", type: "Corporate Recycler", rating: 4.7, icon: "üè¢", verified: true },
            { name: "JustDispose", state: "Maharashtra", city: "Mumbai", address: "Kanjurmarg East, Mumbai, Maharashtra", type: "Pickup Service", rating: 4.5, icon: "üöö", verified: true },
            { name: "Poornam Ecovision", state: "Maharashtra", city: "Pune", address: "Survey No 29, Dhankawadi, Pune", type: "NGO / Collection", rating: 4.8, icon: "‚ôªÔ∏è", verified: true },

            // Karnataka (Bangalore)
            { name: "Sogo Synergies", state: "Karnataka", city: "Bangalore", address: "Plot No. D-22, KIADB Industrial Area, Bangalore", type: "Processing Facility", rating: 4.6, icon: "üè≠", verified: true },
            { name: "E-Parisaraa", state: "Karnataka", city: "Bangalore", address: "Dobaspet Industrial Area, Bangalore Rural", type: "Authorized Recycler", rating: 4.7, icon: "‚ôªÔ∏è", verified: true },

            // Hyderabad & Chennai
            { name: "Earth Sense Recycle", state: "Telangana", city: "Hyderabad", address: "Plot 37, APIIC Industrial Park, Hyderabad", type: "Recycling Plant", rating: 4.6, icon: "üè≠", verified: true },
            { name: "Tes-Amm India", state: "Tamil Nadu", city: "Chennai", address: "SIPCOT Industrial Growth Centre, Oragadam, Chennai", type: "Global Recycler", rating: 4.9, icon: "üåç", verified: true }
        ];

        // Impact Data
        const impactDB = {
            'laptop': { co2: 15.5, tree: 1.2, energy: 22 },
            'phone': { co2: 3.2, tree: 0.2, energy: 3.8 },
            'monitor': { co2: 9.2, tree: 0.6, energy: 14.5 },
            'keyboard': { co2: 1.5, tree: 0.1, energy: 1.2 },
            'mouse': { co2: 0.8, tree: 0.05, energy: 0.9 },
            'tv': { co2: 18.0, tree: 1.4, energy: 25 },
            'bottle': { co2: 0.1, tree: 0.01, energy: 0.2 }
        };

        const aiMap = {
            'cell phone': 'phone', 'mobile phone': 'phone',
            'laptop': 'laptop', 'mouse': 'mouse', 'keyboard': 'keyboard',
            'tv': 'tv', 'monitor': 'monitor', 'bottle': 'bottle'
        };

        // --- 2. REWARDS LOGIC ---
        function checkDailyReward() {
            const lastRewardDate = localStorage.getItem('lastRewardDate');
            const today = new Date().toDateString();
            let currentPoints = parseInt(localStorage.getItem('ecoPoints')) || 1250; 
            
            updatePointsDisplay(currentPoints);

            if (lastRewardDate !== today) {
                setTimeout(() => {
                    document.getElementById('daily-reward-popup').classList.add('show');
                }, 1500);
            }
        }

        function claimReward() {
            const today = new Date().toDateString();
            let currentPoints = parseInt(localStorage.getItem('ecoPoints')) || 1250;
            
            currentPoints += 50;
            
            localStorage.setItem('ecoPoints', currentPoints);
            localStorage.setItem('lastRewardDate', today);
            
            updatePointsDisplay(currentPoints);
            document.getElementById('daily-reward-popup').classList.remove('show');
            alert("50 Points added to your wallet! üéâ");
        }

        function updatePointsDisplay(pts) {
            document.getElementById('nav-points').innerText = `üèÜ ${pts} Pts`;
            if(document.getElementById('store-points')) document.getElementById('store-points').innerText = pts;
        }

        function redeemCoupon(cost, btnElement) {
            let pts = parseInt(localStorage.getItem('ecoPoints')) || 1250;
            if(pts >= cost) {
                pts -= cost;
                localStorage.setItem('ecoPoints', pts);
                updatePointsDisplay(pts);
                
                // Reveal Code
                btnElement.style.display = 'none';
                const codeDiv = btnElement.nextElementSibling;
                codeDiv.classList.add('revealed');
                alert("Coupon Redeemed Successfully! üéâ");
            } else {
                alert("Not enough points! Recycle more items to earn points.");
            }
        }

        // --- 3. NAVIGATION ---
        function navigate(e, pageId) {
            if(e) e.preventDefault();
            document.querySelectorAll('section').forEach(el => el.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0,0);
            
            if(pageId === 'impact') startLiveCounter();
        }

        // --- 4. SOLUTIONS PAGE (FILTERING LOGIC) ---
        function loadSolutions(filteredData) {
            const container = document.getElementById('solutions-list');
            if(!container) return;
            container.innerHTML = '';

            const dataToRender = filteredData || facilitiesDB;

            if (dataToRender.length === 0) {
                container.innerHTML = '<div style="text-align:center; padding:2rem; color:#666;">No facilities found matching your criteria.</div>';
                return;
            }

            dataToRender.forEach(fac => {
                let badges = fac.verified ? `<span class="s-badge verified">‚úì Verified</span>` : '';
                let mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(fac.name + ' ' + fac.address)}`;
                
                let html = `
                    <div class="s-card">
                        <div class="s-img-container">
                            ${fac.icon}
                            <div class="s-badge-container">${badges}</div>
                        </div>
                        <div class="s-card-content">
                            <div style="display:flex; justify-content:space-between;">
                                <h3 style="font-weight:700;">${fac.name}</h3>
                                <span style="font-size:0.9rem; color:#F59E0B;">‚òÖ ${fac.rating}</span>
                            </div>
                            <p class="s-meta">üìç ${fac.city}, ${fac.state}</p>
                            <p style="font-size:0.85rem; color:#666; margin-bottom:1rem;">${fac.address}</p>
                            <div class="s-actions">
                                <a href="${mapUrl}" target="_blank" class="btn btn-primary btn-sm btn-full" style="color:white; text-decoration:none;">Get Directions ‚Üó</a>
                                <button class="btn btn-outline btn-sm btn-full">Call Now</button>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function filterSolutions() {
            const stateVal = document.getElementById('state-filter').value;
            const searchVal = document.getElementById('search-input').value.toLowerCase();

            const filtered = facilitiesDB.filter(fac => {
                const matchState = stateVal === "" || fac.state === stateVal;
                const matchSearch = fac.city.toLowerCase().includes(searchVal) || 
                                    fac.name.toLowerCase().includes(searchVal) ||
                                    fac.address.toLowerCase().includes(searchVal);
                return matchState && matchSearch;
            });
            loadSolutions(filtered);
        }

        // --- 5. LIVE DASHBOARD (REAL STATS) ---
        let counterInterval;
        function startLiveCounter() {
            if(counterInterval) clearInterval(counterInterval);
            const ratePerSec = 1966.05;
            const startOfYear = new Date(new Date().getFullYear(), 0, 1).getTime();
            const startOfDay = new Date().setHours(0,0,0,0);
            
            const update = () => {
                const now = Date.now();
                const secondsSinceYear = (now - startOfYear) / 1000;
                const secondsSinceToday = (now - startOfDay) / 1000;
                const wasteYear = secondsSinceYear * ratePerSec;
                const wasteToday = secondsSinceToday * ratePerSec;
                const recycled = wasteYear * 0.223; 

                document.getElementById('global-waste-kg').innerText = Math.floor(wasteYear).toLocaleString();
                document.getElementById('today-waste-kg').innerText = Math.floor(wasteToday).toLocaleString();
                document.getElementById('recycled-waste-kg').innerText = Math.floor(recycled).toLocaleString();
            };
            update();
            counterInterval = setInterval(update, 100);
        }

        // --- 6. CALCULATOR ---
        function initCalculator() {
            const select = document.getElementById('calc-device');
            if(!select) return;
            select.innerHTML = '<option value="" disabled selected>Select Device</option>';
            for (let key in impactDB) {
                let opt = document.createElement('option');
                opt.value = key;
                opt.innerText = key.charAt(0).toUpperCase() + key.slice(1);
                select.appendChild(opt);
            }
        }

        function calculateImpact() {
            const key = document.getElementById('calc-device').value;
            const qty = document.getElementById('calc-qty').value;
            if(!key || qty < 1) return alert("Please fill all fields");

            const data = impactDB[key];
            document.getElementById('res-co2').innerText = (data.co2 * qty).toFixed(1) + " kg";
            document.getElementById('res-tree').innerText = (data.tree * qty).toFixed(1);
            document.getElementById('res-energy').innerText = (data.energy * qty).toFixed(1) + " kWh";
            document.getElementById('res-water').innerText = (qty * 10) + " L"; 

            document.getElementById('calc-empty').style.display = 'none';
            document.getElementById('calc-filled').style.display = 'block';
        }
        function resetCalculator() {
            document.getElementById('calc-empty').style.display = 'flex';
            document.getElementById('calc-filled').style.display = 'none';
            document.getElementById('calc-device').selectedIndex = 0;
            document.getElementById('calc-qty').value = 1;
        }

        // --- 7. WIZARD ---
        let currentStep = 1;
        function selectCategory(el, cat) {
            document.querySelectorAll('.category-option').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
        }
        function changeStep(dir) {
            document.getElementById(`step-content-${currentStep}`).classList.add('hidden');
            document.getElementById(`step-indicator-${currentStep}`).classList.remove('active');
            if(dir > 0) document.getElementById(`step-indicator-${currentStep}`).classList.add('completed');
            
            currentStep += dir;
            
            document.getElementById(`step-content-${currentStep}`).classList.remove('hidden');
            document.getElementById(`step-indicator-${currentStep}`).classList.add('active');
            
            const nextBtn = document.getElementById('next-btn');
            document.getElementById('prev-btn').style.display = currentStep > 1 ? 'block' : 'none';
            
            if(currentStep === 4) {
                nextBtn.style.display = 'none';
                
                // AWARD POINTS LOGIC
                let pts = parseInt(localStorage.getItem('ecoPoints')) || 1250;
                pts += 100; // Reward for submission
                localStorage.setItem('ecoPoints', pts);
                updatePointsDisplay(pts);
            }
            else { nextBtn.style.display = 'block'; nextBtn.innerText = currentStep === 3 ? 'Submit Request' : 'Continue'; }
        }
        function handleFiles(files) {
            const gal = document.getElementById('gallery');
            gal.innerHTML = '';
            Array.from(files).forEach(f => {
                let img = document.createElement('img');
                img.src = URL.createObjectURL(f);
                img.className = 'preview-img';
                gal.appendChild(img);
            });
        }

        // --- 8. AI CAMERA ---
        let model = null;
        async function loadModel() {
            try {
                model = await cocoSsd.load();
                document.getElementById('model-status').innerText = "‚úÖ AI Ready";
            } catch(e) { console.log("AI Error", e); }
        }

        async function startCamera() {
            if(!model) await loadModel();
            const video = document.getElementById('webcam');
            const scanLine = document.getElementById('scan-line');
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });
                video.srcObject = stream;
                document.getElementById('placeholder').style.display = 'none';
                scanLine.style.display = 'block';
                video.onloadeddata = () => { detectFrame(video); };
            } catch(e) { alert("Please enable camera permissions."); }
        }

        async function detectFrame(video) {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            if(model) {
                const predictions = await model.detect(video);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                predictions.forEach(p => {
                    if(p.score > 0.6) {
                        const [x,y,w,h] = p.bbox;
                        ctx.strokeStyle = '#10B981'; ctx.lineWidtah = 4; ctx.strokeRect(x,y,w,h);
                        ctx.fillStyle = '#10B981'; ctx.fillRect(x, y-25, w, 25);
                        ctx.fillStyle = 'white'; ctx.font = '18px Arial';
                        ctx.fillText(p.class.toUpperCase() + ' (' + Math.round(p.score*100) + '%)', x+5, y-5);
                        
                        const dbKey = aiMap[p.class.toLowerCase()];
                        if(dbKey && impactDB[dbKey]) {
                            document.getElementById('item-name').innerText = p.class.toUpperCase();
                            document.getElementById('val-co2').innerText = impactDB[dbKey].co2;
                            document.getElementById('val-energy').innerText = impactDB[dbKey].energy;
                        }
                    }
                });
            }
            requestAnimationFrame(() => detectFrame(video));
        }

        // INIT
        window.onload = () => {
            loadModel();
            initCalculator();
            loadSolutions(); 
            checkDailyReward();
        };

    </script>
</body>
</html>