<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoCircuit | Comprehensive E-Waste AI Platform</title>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>

    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --primary: #10B981; 
            --primary-hover: #059669;
            --secondary: #3B82F6; 
            --dark: #111827; 
            --light: #F3F4F6; 
            --white: #ffffff;
            --gradient: linear-gradient(135deg, #ecfdf5 0%, #eff6ff 100%);
            --cta-gradient: linear-gradient(135deg, #10B981 0%, #3B82F6 100%);
            --text-gray: #6B7280;
            --border: #E5E7EB;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { color: var(--dark); background-color: #F9FAFB; line-height: 1.6; }

        /* --- UTILITIES --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 5%; }
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer; border: none; transition: all 0.2s ease; width: auto; font-size: 0.95rem; text-decoration: none; }
        .btn-primary { background: var(--primary); color: var(--white); box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2); }
        .btn-primary:hover { background: var(--primary-hover); transform: translateY(-1px); }
        .btn-outline { background: white; border: 1px solid #e5e7eb; color: var(--dark); }
        .btn-outline:hover { background: #f9fafb; border-color: #d1d5db; }
        .btn-sm { padding: 0.4rem 1rem; font-size: 0.85rem; }
        .btn-white { background: white; color: var(--primary); font-weight: 700; border-radius: 50px; }
        .btn-white:hover { background: #f9fafb; transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .btn-outline-white { background: transparent; border: 1px solid rgba(255,255,255,0.4); color: white; border-radius: 50px; }
        .btn-outline-white:hover { background: rgba(255,255,255,0.1); border-color: white; }
        .btn-full { width: 100%; }
        
        .hidden { display: none; }

        /* --- NAVBAR --- */
        .navbar { padding: 1.5rem 0; background: var(--white); box-shadow: 0 1px 3px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100; }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 800; display: flex; align-items: center; gap: 0.5rem; cursor: pointer; }
        .logo span { color: var(--primary); }
        .nav-links { display: flex; gap: 1.5rem; }
        .nav-links a { text-decoration: none; color: var(--dark); font-weight: 500; transition: color 0.2s; font-size: 0.95rem; }
        .nav-links a:hover, .nav-links a.active { color: var(--primary); }

        /* --- SECTION VISIBILITY --- */
        section { display: none !important; }
        section.active { display: block !important; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- HERO & CAMERA STYLES --- */
        .hero { background: var(--gradient); min-height: 90vh; padding-top: 2rem; display: flex; flex-direction: column; }
        .hero-layout { display: flex; align-items: center; justify-content: space-between; gap: 2rem; width: 100%; padding-bottom: 4rem; }
        .hero-text { flex: 1; }
        .hero h1 { font-size: 3.5rem; line-height: 1.1; margin-bottom: 1.5rem; }
        
        .hero-card { flex: 1; background: var(--white); padding: 1.5rem; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); max-width: 500px; text-align: center; }
        .camera-wrapper { position: relative; width: 100%; height: 300px; background: #000; border-radius: 12px; overflow: hidden; margin-bottom: 1rem; }
        video, canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        canvas { z-index: 10; }
        .camera-placeholder { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; z-index: 20; background: #111; }

        /* --- IMPACT GRID (HERO) --- */
        .impact-dashboard { margin-top: 1rem; text-align: left; }
        .impact-title { font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; color: #4B5563; }
        .impact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .impact-item { background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 15px; display: flex; flex-direction: column; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .impact-icon { font-size: 1.5rem; margin-bottom: 5px; }
        .impact-val { font-size: 1.4rem; font-weight: 800; line-height: 1.2; }
        .impact-unit { font-size: 0.8rem; color: #666; font-weight: 500; }
        .color-co2 { color: #10B981; } .color-tree { color: #059669; } .color-energy { color: #F59E0B; } .color-water { color: #2563EB; }

        /* --- CTA SECTION --- */
        .cta-section { background: var(--cta-gradient); color: white; padding: 5rem 0 0 0; text-align: center; width: 100%; position: relative; overflow: hidden; }
        .cta-content { max-width: 1200px; margin: 0 auto; padding: 0 5%; position: relative; z-index: 2; }
        .cta-header h2 { font-size: 2.8rem; font-weight: 800; margin-bottom: 1rem; letter-spacing: -0.5px; }
        .cta-header p { font-size: 1.1rem; opacity: 0.9; max-width: 700px; margin: 0 auto 4rem auto; }
        
        .glass-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 3rem; }
        .glass-card { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); border-radius: 16px; padding: 2rem 1.5rem; text-align: left; transition: transform 0.3s; }
        .glass-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.15); }
        .glass-icon { font-size: 1.5rem; margin-bottom: 1rem; display: inline-block; padding: 8px; border: 1px solid rgba(255,255,255,0.3); border-radius: 8px; }
        .glass-card h3 { font-size: 1.1rem; margin-bottom: 0.5rem; font-weight: 700; }
        .glass-card p { font-size: 0.85rem; opacity: 0.8; line-height: 1.5; }

        .cta-stats-bar { background: rgba(0, 0, 0, 0.2); backdrop-filter: blur(5px); padding: 3rem 0; margin-top: 5rem; display: flex; justify-content: space-around; flex-wrap: wrap; gap: 2rem; border-top: 1px solid rgba(255,255,255,0.1); }
        .cta-stat h3 { font-size: 2.5rem; font-weight: 800; margin-bottom: 0.25rem; }
        .cta-stat p { font-size: 0.9rem; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; }

        /* --- FOOTER --- */
        .site-footer { background: white; color: var(--dark); padding: 4rem 0 2rem 0; text-align: left; border-top: 1px solid #eee; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 2rem; max-width: 1200px; margin: 0 auto; padding: 0 5%; }
        .footer-col h4 { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 1.5rem; color: #9CA3AF; }
        .footer-col ul { list-style: none; }
        .footer-col li { margin-bottom: 0.8rem; }
        .footer-col a { text-decoration: none; color: var(--dark); font-size: 0.9rem; transition: color 0.2s; cursor: pointer; }
        .footer-col a:hover { color: var(--primary); }

        /* --- CALCULATOR --- */
        .calc-header { text-align: center; margin-bottom: 3rem; }
        .calc-header h2 { font-size: 2.5rem; font-family: monospace; font-weight: 700; margin-bottom: 0.5rem; }
        .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; max-width: 1000px; margin: 0 auto; }
        .calc-card { background: white; border: 1px solid var(--border); border-radius: 16px; padding: 2.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .calc-info { margin-top: 2rem; background: #f0fdf4; padding: 1rem; border-radius: 8px; border: 1px solid #d1fae5; color: #065f46; display: flex; gap: 0.75rem; }
        .result-empty { text-align: center; color: var(--text-gray); display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; }
        .result-filled { display: none; animation: fadeIn 0.5s ease; }
        .res-row { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; border-bottom: 1px solid #f3f4f6; }
        
        /* --- WIZARD --- */
        .stepper { display: flex; justify-content: center; align-items: center; margin-bottom: 3rem; gap: 1rem; position: relative; max-width: 800px; margin: 0 auto; }
        .step { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; position: relative; z-index: 2; width: 80px; }
        .step-circle { width: 40px; height: 40px; border-radius: 50%; background: white; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 600; color: var(--text-gray); transition: all 0.3s; }
        .step.active .step-circle { border-color: var(--primary); color: var(--primary); background: #ecfdf5; }
        .step.completed .step-circle { background: var(--primary); color: white; border-color: var(--primary); }
        .stepper::before { content: ''; position: absolute; top: 20px; left: 50px; right: 50px; height: 2px; background: var(--border); z-index: 1; }
        
        .wizard-card { background: white; border: 1px solid var(--border); border-radius: 16px; padding: 2rem; max-width: 900px; margin: 0 auto; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; }
        .category-option { border: 2px solid var(--border); border-radius: 12px; padding: 1.5rem 1rem; text-align: center; cursor: pointer; transition: all 0.2s; }
        .category-option:hover { border-color: var(--primary); background: #f0fdf4; transform: translateY(-2px); }
        .category-option.selected { border-color: var(--primary); background: #ecfdf5; }
        .cat-icon { font-size: 2rem; margin-bottom: 0.5rem; display: block; }
        
        .upload-area { border: 2px dashed var(--border); border-radius: 12px; padding: 3rem; text-align: center; cursor: pointer; background: #fafafa; }
        .preview-container { margin-top: 1rem; display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; }
        .preview-img { width: 100%; height: 100px; object-fit: cover; border-radius: 8px; border: 1px solid var(--border); }

        /* --- DASHBOARD --- */
        .dashboard-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem; }
        .dashboard-title h2 { font-size: 2.2rem; margin-bottom: 0.5rem; font-family: monospace; font-weight: 700; letter-spacing: -1px; }
        .live-panel { background: white; border: 1px solid #e5e7eb; border-radius: 16px; padding: 1.5rem; margin-bottom: 2rem; }
        .live-stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 2rem; }
        .live-stat .value { font-size: 1.75rem; font-weight: 800; color: var(--dark); }
        .live-stat .value.green { color: var(--primary); }
        .live-stat .value.orange { color: #F97316; }
        .main-stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.5rem; }
        .stat-card-new { background: white; border: 1px solid #e5e7eb; border-radius: 16px; padding: 1.5rem; position: relative; transition: transform 0.2s; }
        .stat-card-new:hover { transform: translateY(-3px); }
        .card-icon { width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; margin-bottom: 1.5rem; }
        .icon-device { color: #10B981; border: 1px solid #10B981; }
        .icon-leaf { color: #059669; border: 1px solid #059669; }
        .icon-users { color: #3B82F6; border: 1px solid #3B82F6; }
        .icon-loc { color: #F59E0B; border: 1px solid #F59E0B; }
        .trend { position: absolute; top: 1.5rem; right: 1.5rem; font-size: 0.85rem; font-weight: 600; color: #10B981; }

        /* --- REDESIGNED SOLUTIONS MAP STYLES --- */
        .solutions-header { text-align: center; margin-bottom: 3rem; }
        .solutions-header p { max-width: 600px; margin: 0 auto; color: var(--text-gray); }
        
        /* Stats Row */
        .solutions-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 3rem; }
        .s-stat-card { background: white; padding: 1.5rem; border-radius: 12px; border: 1px solid #e5e7eb; display: flex; flex-direction: column; gap: 0.5rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .s-stat-icon { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1rem; margin-bottom: 0.5rem; }
        .icon-fac { background: #DCFCE7; color: #166534; } .icon-part { background: #E0F2FE; color: #075985; } .icon-cit { background: #ede9fe; color: #5b21b6; } .icon-usr { background: #ffedd5; color: #9a3412; }
        .s-stat-label { font-size: 0.85rem; color: #6B7280; font-weight: 500; }
        .s-stat-val { font-size: 1.5rem; font-weight: 700; color: var(--dark); line-height: 1; }

        /* Main Layout */
        .solutions-layout { display: grid; grid-template-columns: 280px 1fr; gap: 2rem; }
        
        /* Sidebar */
        .s-sidebar { background: white; border-radius: 16px; padding: 1.5rem; border: 1px solid #e5e7eb; height: fit-content; }
        .s-filter-group { margin-bottom: 1.5rem; }
        .s-filter-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .s-filter-title { font-weight: 700; font-size: 1.1rem; }
        .s-label { font-size: 0.85rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem; display: block; }
        
        .s-input-group { position: relative; margin-bottom: 1rem; }
        .s-input { width: 100%; padding: 0.6rem 0.8rem; padding-left: 2rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 0.9rem; }
        .s-search-icon { position: absolute; left: 0.7rem; top: 50%; transform: translateY(-50%); color: #9ca3af; font-size: 0.9rem; }
        
        .s-select { width: 100%; padding: 0.6rem; border: 1px solid #d1d5db; border-radius: 8px; font-size: 0.9rem; background: white; color: #374151; margin-bottom: 1rem; }
        
        .s-checkbox-group { display: flex; flex-direction: column; gap: 0.6rem; }
        .s-checkbox { display: flex; align-items: center; gap: 0.6rem; font-size: 0.9rem; color: #4b5563; cursor: pointer; }
        .s-checkbox input { accent-color: var(--primary); width: 16px; height: 16px; }

        /* Facility Grid */
        .s-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; }
        .s-card { background: white; border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden; transition: transform 0.2s, box-shadow 0.2s; display: flex; flex-direction: column; }
        .s-card:hover { transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        
        .s-img-container { height: 160px; background: #f3f4f6; position: relative; display: flex; align-items: center; justify-content: center; color: #9ca3af; font-size: 3rem; }
        .s-badge-container { position: absolute; top: 10px; right: 10px; display: flex; gap: 5px; }
        .s-badge { font-size: 0.7rem; padding: 2px 8px; border-radius: 4px; font-weight: 600; background: rgba(0,0,0,0.6); color: white; backdrop-filter: blur(2px); }
        .s-badge.verified { background: var(--primary); }
        
        .s-card-content { padding: 1.25rem; flex: 1; display: flex; flex-direction: column; }
        .s-card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem; }
        .s-card-title { font-weight: 700; font-size: 1.05rem; line-height: 1.3; color: var(--dark); margin-right: 0.5rem; }
        .s-rating { display: flex; align-items: center; font-size: 0.85rem; font-weight: 600; color: #374151; gap: 2px; }
        .star { color: #F59E0B; }
        .s-reviews { color: #9CA3AF; font-weight: 400; margin-left: 2px; font-size: 0.8rem; }
        
        .s-meta { font-size: 0.85rem; color: #6B7280; display: flex; flex-direction: column; gap: 0.3rem; margin-bottom: 1rem; }
        .s-meta-item { display: flex; align-items: center; gap: 0.4rem; }
        .s-open { color: #16A34A; font-weight: 600; font-size: 0.8rem; display: inline-flex; align-items: center; gap: 4px; margin-top: 5px; }
        
        .s-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 1.5rem; }
        .s-tag { font-size: 0.75rem; background: #F3F4F6; color: #4B5563; padding: 3px 8px; border-radius: 4px; font-weight: 500; }
        
        .s-actions { margin-top: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        @media (max-width: 900px) {
            .solutions-layout { grid-template-columns: 1fr; }
            .hero h1 { font-size: 2.5rem; }
        }
        
        /* Form Inputs */
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--dark); }
        .form-input, .form-select { width: 100%; padding: 0.75rem 1rem; border: 1px solid var(--border); border-radius: 8px; font-size: 1rem; transition: border 0.2s; background: white; }
        .form-input:focus, .form-select:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1); }
        optgroup { font-weight: 700; color: var(--text-gray); }

        @media (max-width: 768px) {
            .hero-layout, .calc-grid, .category-grid { grid-template-columns: 1fr; }
            .nav-links { display: none; }
            .stepper { display: none; } 
            .cta-stats-bar { flex-direction: column; gap: 2rem; }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="container nav-content">
            <div class="logo" onclick="navigate(event, 'home')">
                ‚ôªÔ∏è Eco<span>Circuit</span>
            </div>
            <div class="nav-links">
                <a href="#" onclick="navigate(event, 'solutions')" id="nav-solutions">Solutions</a>
                <a href="#" onclick="navigate(event, 'impact')" id="nav-impact">Impact</a>
                <a href="#" onclick="navigate(event, 'calculator')" id="nav-calculator">Calculator</a>
                <a href="#" onclick="navigate(event, 'submit-waste')" id="nav-submit-waste" class="btn btn-primary btn-sm" style="color:white; padding: 0.5rem 1rem;">Submit E-Waste</a>
            </div>
            <button class="btn btn-outline btn-sm" onclick="navigate(event, 'home')">Scan Item</button>
        </div>
    </nav>

    <section id="home" class="hero active">
        <div class="container hero-layout">
            <div class="hero-text">
                <h1>Classify E-Waste with <span style="color:var(--primary)">AI</span></h1>
                <p>Detects ICT, Consumer Electronics, Appliances, and Tools directly in your browser.</p>
                <div style="margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="startCamera()">Start AI Scanner</button>
                    <button class="btn btn-outline" onclick="navigate(event, 'submit-waste')" style="margin-left: 10px;">Manual Upload</button>
                </div>
            </div>
            
            <div class="hero-card">
                <h3>Live Detection Feed</h3>
                <span style="background:#e5e7eb; padding:4px 8px; border-radius:4px; font-size:0.75rem;" id="model-status">Loading AI Model...</span>
                <div class="camera-wrapper">
                    <div class="camera-placeholder" id="placeholder">
                        <div style="font-size: 2rem;">üì∑</div>
                        <p>Waiting for permission...</p>
                    </div>
                    <video id="webcam" autoplay playsinline muted></video>
                    <canvas id="canvas"></canvas>
                </div>
                <div class="impact-dashboard">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <span class="impact-title">Detected: <span id="item-name" style="color:var(--primary); font-weight:800;">Waiting...</span></span>
                    </div>
                    <div class="impact-grid">
                        <div class="impact-item"><div class="impact-icon">üçÉ</div><div class="impact-val color-co2" id="val-co2">--</div><div class="impact-unit">kg CO‚ÇÇ</div></div>
                        <div class="impact-item"><div class="impact-icon">üå≥</div><div class="impact-val color-tree" id="val-tree">--</div><div class="impact-unit">Trees</div></div>
                        <div class="impact-item"><div class="impact-icon">‚ö°</div><div class="impact-val color-energy" id="val-energy">--</div><div class="impact-unit">kWh</div></div>
                        <div class="impact-item"><div class="impact-icon">üíß</div><div class="impact-val color-water" id="val-water">--</div><div class="impact-unit">Liters</div></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="cta-section">
            <div class="cta-content">
                <div class="cta-header">
                    <h2>Ready to Make a Difference?</h2>
                    <p>Join our growing community of environmental champions.</p>
                </div>
                <div class="glass-grid">
                    <div class="glass-card"><div class="glass-icon">üì§</div><h3>Submit Devices</h3><p>Quick and easy device submission.</p></div>
                    <div class="glass-card"><div class="glass-icon">üìä</div><h3>Track Impact</h3><p>Real-time dashboard visualization.</p></div>
                    <div class="glass-card"><div class="glass-icon">üéñÔ∏è</div><h3>Earn Rewards</h3><p>Unlock achievements.</p></div>
                    <div class="glass-card"><div class="glass-icon">üë•</div><h3>Join Community</h3><p>Connect with others.</p></div>
                </div>
                <div style="margin-bottom: 2rem;">
                    <button class="btn btn-white" onclick="navigate(event, 'submit-waste')">Submit Your First Device</button>
                    <button class="btn btn-outline-white" style="margin-left: 10px;" onclick="navigate(event, 'impact')">View Impact Dashboard</button>
                </div>
            </div>
            <div class="cta-stats-bar">
                <div class="cta-stat"><h3>‚ôªÔ∏è 847K+</h3><p>Devices Recycled</p></div>
                <div class="cta-stat"><h3>üë§ 45K+</h3><p>Active Members</p></div>
                <div class="cta-stat"><h3>üåç 12.4K</h3><p>Tons CO2 Saved</p></div>
            </div>
        </div>
        
        <footer class="site-footer">
            <div class="footer-grid">
                <div class="footer-col"><h4>Platform</h4><ul><li><a href="#" onclick="navigate(event, 'submit-waste')">Submit</a></li><li><a href="#" onclick="navigate(event, 'impact')">Dashboard</a></li></ul></div>
                <div class="footer-col"><h4>Resources</h4><ul><li><a href="#">About Us</a></li><li><a href="#">Recycling Guides</a></li></ul></div>
                <div class="footer-col"><h4>Legal</h4><ul><li><a href="#">Privacy Policy</a></li><li><a href="#">Terms of Service</a></li></ul></div>
            </div>
            <div style="text-align: center; margin-top: 3rem; color: #9CA3AF; font-size: 0.8rem;">¬© 2026 EcoCircuit. All rights reserved.</div>
        </footer>
    </section>

    <section id="calculator" class="container" style="padding: 4rem 0;">
        <div class="calc-header">
            <span style="color:#F59E0B; font-weight:600; font-size:0.9rem;">üßÆ Impact Calculator</span>
            <h2>Calculate Your Potential Impact</h2>
            <p style="color:var(--text-gray);">Comprehensive data for ICT, Home Electronics, and Appliances.</p>
        </div>
        <div class="calc-grid">
            <div class="calc-card">
                <h3 style="margin-bottom:1.5rem; font-family:monospace; font-size:1.25rem;">Enter Your Devices</h3>
                <div class="form-group">
                    <label class="form-label">Device Type <span style="color:red">*</span></label>
                    <select class="form-select" id="calc-device"></select>
                </div>
                <div class="form-group">
                    <label class="form-label">Quantity <span style="color:red">*</span></label>
                    <input type="number" class="form-input" id="calc-qty" value="1" min="1">
                </div>
                <div style="display:flex; gap:1rem; margin-top:2rem;">
                    <button class="btn btn-primary" style="flex:1" onclick="calculateImpact()">Calculate Impact</button>
                    <button class="btn btn-outline" style="flex:1" onclick="resetCalculator()">‚Üª Reset</button>
                </div>
            </div>
            <div class="calc-card">
                <div id="calc-empty" class="result-empty">
                    <div style="font-size:4rem; margin-bottom:1rem; opacity:0.3; background:#f3f4f6; width:100px; height:100px; border-radius:50%; display:flex; align-items:center; justify-content:center;">üçÉ</div>
                    <h3 style="color:var(--dark); margin-bottom:0.5rem; font-family:monospace;">Your Impact Results</h3>
                    <p style="font-size:0.9rem;">Select a device type and quantity.</p>
                </div>
                <div id="calc-filled" class="result-filled">
                    <h3 style="margin-bottom:1.5rem; font-family:monospace; text-align:center;">Estimated Savings</h3>
                    <div class="res-row"><div class="res-label"><span style="font-size:1.5rem;">üçÉ</span> CO‚ÇÇ Emissions</div><div class="res-val" id="res-co2">0 kg</div></div>
                    <div class="res-row"><div class="res-label"><span style="font-size:1.5rem;">üå≥</span> Trees Planted</div><div class="res-val" id="res-tree">0</div></div>
                    <div class="res-row"><div class="res-label"><span style="font-size:1.5rem;">‚ö°</span> Energy Saved</div><div class="res-val" id="res-energy">0 kWh</div></div>
                    <div class="res-row"><div class="res-label"><span style="font-size:1.5rem;">üíß</span> Water Saved</div><div class="res-val" id="res-water">0 L</div></div>
                    <div style="margin-top:2rem; text-align:center;">
                        <button class="btn btn-primary btn-sm" onclick="navigate(event, 'submit-waste')">Recycle This Item Now ‚Üí</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="submit-waste" class="container" style="padding: 4rem 0;">
        <div class="calc-header">
            <h2>Submit E-Waste</h2>
            <p>Help us build a sustainable future by responsibly recycling.</p>
        </div>
        <div class="stepper">
            <div class="step active" id="step-indicator-1"><div class="step-circle">1</div><span class="step-label">Category</span></div>
            <div class="step" id="step-indicator-2"><div class="step-circle">2</div><span class="step-label">Details</span></div>
            <div class="step" id="step-indicator-3"><div class="step-circle">3</div><span class="step-label">Photos</span></div>
            <div class="step" id="step-indicator-4"><div class="step-circle">4</div><span class="step-label">Location</span></div>
            <div class="step" id="step-indicator-5"><div class="step-circle">5</div><span class="step-label">Review</span></div>
        </div>
        <div class="wizard-card">
            <div id="step-content-1">
                <div class="category-grid">
                    <div class="category-option" onclick="selectCategory(this, 'ICT')"><span class="cat-icon">üíª</span><span class="cat-name">ICT / Computers</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'Mobile')"><span class="cat-icon">üì±</span><span class="cat-name">Mobile / Phones</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'Consumer')"><span class="cat-icon">üì∫</span><span class="cat-name">Consumer Electronics</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'LargeApp')"><span class="cat-icon">‚ùÑÔ∏è</span><span class="cat-name">Large Appliances</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'SmallApp')"><span class="cat-icon">üçû</span><span class="cat-name">Small Appliances</span></div>
                    <div class="category-option" onclick="selectCategory(this, 'Other')"><span class="cat-icon">üîå</span><span class="cat-name">Tools / Other</span></div>
                </div>
            </div>
            <div id="step-content-2" class="hidden">
                <div class="form-group"><label class="form-label">Specific Item</label><input type="text" class="form-input" placeholder="e.g. Dell Monitor, Fridge, Microwave"></div>
                <div class="form-group"><label class="form-label">Condition</label><select class="form-select"><option>Working</option><option>Broken</option><option>For Parts</option></select></div>
            </div>
            <div id="step-content-3" class="hidden">
                <div class="upload-area" onclick="document.getElementById('file-input').click()">
                    <div style="font-size:3rem;">üì∑</div><h3>Click or Drag photos here</h3>
                    <input type="file" id="file-input" multiple accept="image/*" style="display:none;" onchange="handleFiles(this.files)">
                </div>
                <div class="preview-container" id="gallery"></div>
            </div>
            <div id="step-content-4" class="hidden">
                <div class="form-group"><label class="form-label">Address</label><input type="text" class="form-input"></div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:1rem;">
                    <div class="form-group"><label class="form-label">City</label><input type="text" class="form-input"></div>
                    <div class="form-group"><label class="form-label">Zip Code</label><input type="text" class="form-input"></div>
                </div>
            </div>
            <div id="step-content-5" class="hidden">
                <div style="text-align:center;"><div style="font-size:4rem;">‚úÖ</div><p>Ready to submit request for <b id="summary-cat">Device</b>.</p></div>
            </div>
            <div style="margin-top: 2rem; display: flex; justify-content: space-between;">
                <button class="btn btn-outline" id="prev-btn" onclick="changeStep(-1)" style="display:none;">Back</button>
                <button class="btn btn-primary" id="next-btn" style="width:100%;" onclick="changeStep(1)">Continue ></button>
            </div>
        </div>
    </section>

    <section id="solutions" class="container" style="padding: 3rem 0;">
        <div class="solutions-header">
            <span style="color:#10B981; font-weight:600; font-size:0.9rem;">üìç Find Recycling Solutions Near You</span>
            <h2 style="font-size: 2.5rem; margin: 0.5rem 0 1rem 0;">Solutions Map</h2>
            <p>Discover certified recycling facilities, drop-off points, and community initiatives in your area. Making responsible e-waste disposal accessible to everyone.</p>
        </div>

        <div class="solutions-stats">
            <div class="s-stat-card">
                <div class="s-stat-icon icon-fac">üè≠</div>
                <div class="s-stat-label">Total Facilities</div>
                <div class="s-stat-val">1,247</div>
            </div>
            <div class="s-stat-card">
                <div class="s-stat-icon icon-part">ü§ù</div>
                <div class="s-stat-label">Certified Partners</div>
                <div class="s-stat-val">892</div>
            </div>
            <div class="s-stat-card">
                <div class="s-stat-icon icon-cit">üèôÔ∏è</div>
                <div class="s-stat-label">Cities Covered</div>
                <div class="s-stat-val">156</div>
            </div>
            <div class="s-stat-card">
                <div class="s-stat-icon icon-usr">üë•</div>
                <div class="s-stat-label">Active Users</div>
                <div class="s-stat-val">45.2K</div>
            </div>
        </div>

        <div class="solutions-layout">
            <aside class="s-sidebar">
                <div class="s-filter-header">
                    <span class="s-filter-title">Filters</span>
                    <a href="#" style="font-size:0.85rem; color:var(--primary); text-decoration:none;">Reset</a>
                </div>

                <div class="s-filter-group">
                    <label class="s-label">Search Location</label>
                    <div class="s-input-group">
                        <span class="s-search-icon">üîç</span>
                        <input type="text" class="s-input" placeholder="Enter city, zip code...">
                    </div>
                </div>

                <div class="s-filter-group">
                    <label class="s-label">Facility Type</label>
                    <select class="s-select">
                        <option>All Types</option>
                        <option>Recycling Center</option>
                        <option>Drop-off Point</option>
                        <option>Retail Partner</option>
                    </select>
                </div>

                <div class="s-filter-group">
                    <label class="s-label">Distance</label>
                    <select class="s-select">
                        <option>Within 10 miles</option>
                        <option>Within 25 miles</option>
                        <option>Within 50 miles</option>
                    </select>
                </div>
                
                <div class="s-filter-group">
                    <label class="s-label">Sort By</label>
                    <select class="s-select">
                        <option>Nearest first</option>
                        <option>Highest Rated</option>
                    </select>
                </div>

                <div class="s-filter-group">
                    <label class="s-label">Accepted Items</label>
                    <div class="s-checkbox-group">
                        <label class="s-checkbox"><input type="checkbox" checked> Computers & Laptops</label>
                        <label class="s-checkbox"><input type="checkbox" checked> Mobile Phones</label>
                        <label class="s-checkbox"><input type="checkbox"> Batteries</label>
                        <label class="s-checkbox"><input type="checkbox"> Cables & Accessories</label>
                    </div>
                </div>

                <div class="s-filter-group">
                    <label class="s-label">Features</label>
                    <div class="s-checkbox-group">
                        <label class="s-checkbox"><input type="checkbox"> Certified Facilities Only</label>
                        <label class="s-checkbox"><input type="checkbox"> Open Now</label>
                        <label class="s-checkbox"><input type="checkbox"> Free Service</label>
                        <label class="s-checkbox"><input type="checkbox"> Pickup Available</label>
                    </div>
                </div>
            </aside>

            <div class="s-main">
                <div style="margin-bottom:1rem; font-size:0.9rem; color:#6B7280; text-align:right;">
                    üìç Showing facilities relative to Gwalior, MP
                </div>
                <div class="s-grid" id="solutions-list">
                    </div>
            </div>
        </div>
    </section>

    <section id="impact" class="container" style="padding: 4rem 0;">
        <div class="dashboard-header">
            <div class="dashboard-title">
                <h2>Global Impact Dashboard</h2>
                <p>Real-time visualization of our collective environmental progress</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-outline" onclick="exportReport()">‚Üì Export Report</button>
                <button class="btn btn-primary" onclick="shareImpact()">Share Impact</button>
            </div>
        </div>
        <div class="live-panel">
            <div style="display:flex; align-items:center; gap:0.5rem; color:#6B7280; margin-bottom:1.5rem;">
                <div style="width:10px; height:10px; background:#10B981; border-radius:50%; animation:pulse 2s infinite;"></div> Live Updates
            </div>
            <div class="live-stats-row">
                <div class="live-stat"><h4>Devices Today</h4><div class="value" id="today-devices">+111</div></div>
                <div class="live-stat"><h4>CO‚ÇÇ Saved Today</h4><div class="value green" id="today-co2">+580kg</div></div>
                <div class="live-stat"><h4>Active Now</h4><div class="value green" id="active-now">26</div></div>
                <div class="live-stat"><h4>This Hour</h4><div class="value orange" id="this-hour">+29</div></div>
            </div>
        </div>
        <div class="main-stats-grid">
            <div class="stat-card-new"><div class="trend">‚Üó +12.5%</div><div class="card-icon icon-device">üì±</div><h3>Total Devices Collected</h3><div class="big-num" id="total-devices">0</div><span class="unit">devices</span></div>
            <div class="stat-card-new"><div class="trend">‚Üó +8.3%</div><div class="card-icon icon-leaf">üçÉ</div><h3>CO‚ÇÇ Emissions Prevented</h3><div class="big-num" id="total-co2">0</div><span class="unit">kg</span></div>
            <div class="stat-card-new"><div class="trend">‚Üó +15.7%</div><div class="card-icon icon-users">üë•</div><h3>Active Contributors</h3><div class="big-num" id="total-users">0</div><span class="unit">users</span></div>
            <div class="stat-card-new"><div class="trend">‚Üó +5.2%</div><div class="card-icon icon-loc">üìç</div><h3>Recycling Centers</h3><div class="big-num" id="total-centers">0</div><span class="unit">locations</span></div>
        </div>
    </section>

    <script>
        // --- 1. CONFIGURATION & DATABASE ---
        
        // Expanded Database with User's Categories (ICT, Consumer, Appliances, etc.)
        const eWasteDB = {
            // --- ICT ---
            'desktop': { name: 'Desktop PC', category: 'ICT', impact: { co2: '22.0', tree: '1.8', energy: '28.0', water: '210' } },
            'laptop': { name: 'Laptop', category: 'ICT', impact: { co2: '15.5', tree: '1.2', energy: '22.0', water: '190' } },
            'tablet': { name: 'Tablet', category: 'ICT', impact: { co2: '8.5', tree: '0.6', energy: '10.5', water: '90' } },
            'phone': { name: 'Smartphone', category: 'ICT', impact: { co2: '3.2', tree: '0.2', energy: '3.8', water: '48' } },
            'monitor': { name: 'Monitor (LCD/CRT)', category: 'ICT', impact: { co2: '9.2', tree: '0.6', energy: '14.5', water: '80' } },
            'printer': { name: 'Printer/Scanner', category: 'ICT', impact: { co2: '12.0', tree: '0.9', energy: '18.0', water: '120' } },
            'keyboard': { name: 'Keyboard', category: 'ICT', impact: { co2: '1.5', tree: '0.1', energy: '1.2', water: '12' } },
            'mouse': { name: 'Mouse', category: 'ICT', impact: { co2: '0.8', tree: '0.05', energy: '0.9', water: '8' } },
            'router': { name: 'Router/Modem', category: 'ICT', impact: { co2: '2.5', tree: '0.2', energy: '4.0', water: '20' } },
            'harddrive': { name: 'Hard Drive/Storage', category: 'ICT', impact: { co2: '0.5', tree: '0.04', energy: '0.8', water: '5' } },

            // --- CONSUMER ELECTRONICS ---
            'tv': { name: 'Television', category: 'Consumer', impact: { co2: '18.0', tree: '1.4', energy: '25.0', water: '150' } },
            'camera': { name: 'Camera/Video', category: 'Consumer', impact: { co2: '5.0', tree: '0.4', energy: '6.0', water: '40' } },
            'audio': { name: 'Audio/Stereo Eq.', category: 'Consumer', impact: { co2: '7.5', tree: '0.5', energy: '9.0', water: '60' } },
            'remote': { name: 'Remote Control', category: 'Consumer', impact: { co2: '0.3', tree: '0.02', energy: '0.4', water: '2' } },

            // --- LARGE APPLIANCES ---
            'refrigerator': { name: 'Refrigerator', category: 'Large Appl.', impact: { co2: '45.0', tree: '3.5', energy: '150.0', water: '400' } },
            'washing_machine': { name: 'Washing Machine', category: 'Large Appl.', impact: { co2: '35.0', tree: '2.8', energy: '120.0', water: '300' } },
            'oven': { name: 'Oven/Stove', category: 'Large Appl.', impact: { co2: '30.0', tree: '2.4', energy: '100.0', water: '250' } },
            'microwave': { name: 'Microwave', category: 'Large Appl.', impact: { co2: '12.0', tree: '0.9', energy: '40.0', water: '80' } },
            'fan': { name: 'Fan/AC Unit', category: 'Large Appl.', impact: { co2: '8.0', tree: '0.6', energy: '25.0', water: '50' } },

            // --- SMALL APPLIANCES & TOOLS ---
            'toaster': { name: 'Toaster', category: 'Small Appl.', impact: { co2: '4.0', tree: '0.3', energy: '8.0', water: '20' } },
            'kettle': { name: 'Electric Kettle', category: 'Small Appl.', impact: { co2: '3.5', tree: '0.25', energy: '7.0', water: '18' } },
            'hair_dryer': { name: 'Hair Dryer', category: 'Small Appl.', impact: { co2: '2.0', tree: '0.15', energy: '5.0', water: '15' } },
            'tool': { name: 'Power Tool', category: 'Small Appl.', impact: { co2: '6.0', tree: '0.5', energy: '12.0', water: '40' } },

            // --- OTHER ---
            'battery': { name: 'Battery (Li-ion)', category: 'Other', impact: { co2: '0.5', tree: '0.04', energy: '1.0', water: '5' } },
            'toy': { name: 'Electronic Toy', category: 'Other', impact: { co2: '1.5', tree: '0.1', energy: '2.0', water: '10' } },
            'medical': { name: 'Medical Device', category: 'Other', impact: { co2: '10.0', tree: '0.8', energy: '15.0', water: '100' } },
            'bottle': { name: 'Plastic/Waste', category: 'Recyclable', impact: { co2: '0.1', tree: '0.01', energy: '0.2', water: '3' } }
        };

        // AI Mapping: Maps standard COCO-SSD classes to our Database Keys
        const aiMap = {
            'cell phone': 'phone',
            'mobile phone': 'phone',
            'laptop': 'laptop',
            'mouse': 'mouse',
            'keyboard': 'keyboard',
            'tv': 'tv',
            'monitor': 'monitor', 
            'remote': 'remote',
            'refrigerator': 'refrigerator',
            'microwave': 'microwave',
            'oven': 'oven',
            'toaster': 'toaster',
            'hair drier': 'hair_dryer',
            'teddy bear': 'toy', // Proxy for toys
            'scissors': 'tool', // Proxy for tools
            'bottle': 'bottle'
        };

        // --- 2. SPA NAVIGATION ---
        function navigate(event, sectionId) {
            if(event) event.preventDefault();
            document.querySelectorAll('section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-links a').forEach(el => el.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            const navLink = document.getElementById('nav-' + sectionId);
            if(navLink) navLink.classList.add('active');
            
            if(sectionId === 'impact') animateDashboard();
            if(sectionId === 'home') window.scrollTo(0,0);
        }

        // --- 3. IMPACT CALCULATOR LOGIC ---
        function initCalculator() {
            const select = document.getElementById('calc-device');
            if(!select) return;
            
            // Clear existing and repopulate sorted by category
            select.innerHTML = '<option value="" disabled selected>Select a device</option>';
            
            // Group by category
            const grouped = {};
            for (const [key, val] of Object.entries(eWasteDB)) {
                if (!grouped[val.category]) grouped[val.category] = [];
                grouped[val.category].push({key, name: val.name});
            }

            for (const [cat, items] of Object.entries(grouped)) {
                const optgroup = document.createElement('optgroup');
                optgroup.label = cat;
                items.forEach(item => {
                    const opt = document.createElement('option');
                    opt.value = item.key;
                    opt.innerText = item.name;
                    optgroup.appendChild(opt);
                });
                select.appendChild(optgroup);
            }
        }

        function calculateImpact() {
            const deviceKey = document.getElementById('calc-device').value;
            const qty = parseInt(document.getElementById('calc-qty').value) || 0;

            if (!deviceKey) { alert("Please select a device type."); return; }
            if (qty <= 0) { alert("Please enter a valid quantity."); return; }

            const data = eWasteDB[deviceKey];
            if (data) {
                const co2 = (parseFloat(data.impact.co2) * qty).toFixed(1);
                const tree = (parseFloat(data.impact.tree) * qty).toFixed(1);
                const energy = (parseFloat(data.impact.energy) * qty).toFixed(1);
                const water = (parseFloat(data.impact.water) * qty).toFixed(1);

                document.getElementById('res-co2').innerText = co2 + " kg";
                document.getElementById('res-tree').innerText = tree;
                document.getElementById('res-energy').innerText = energy + " kWh";
                document.getElementById('res-water').innerText = water + " L";

                document.getElementById('calc-empty').style.display = 'none';
                document.getElementById('calc-filled').style.display = 'block';
            }
        }

        function resetCalculator() {
            document.getElementById('calc-device').selectedIndex = 0;
            document.getElementById('calc-qty').value = 1;
            document.getElementById('calc-filled').style.display = 'none';
            document.getElementById('calc-empty').style.display = 'flex';
        }

        // --- 4. GENERAL UI LOGIC ---
        document.addEventListener('DOMContentLoaded', () => {
            initCalculator();

            // Populate Solutions Map
            const solContainer = document.getElementById('solutions-list');
            if(solContainer) {
                
                // --- GEOLOCATION LOGIC ---
                // Gwalior Coordinates: 26.2183¬∞ N, 78.1828¬∞ E
                const originLat = 26.2183;
                const originLng = 78.1828;

                function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {
                    var R = 6371; // Radius of the earth in km
                    var dLat = deg2rad(lat2-lat1);  // deg2rad below
                    var dLon = deg2rad(lon2-lon1); 
                    var a = 
                        Math.sin(dLat/2) * Math.sin(dLat/2) +
                        Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon/2) * Math.sin(dLon/2); 
                    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
                    var d = R * c; // Distance in km
                    return d.toFixed(1);
                }

                function deg2rad(deg) {
                    return deg * (Math.PI/180);
                }

                const facilities = [
                    { 
                        name: "Gwalior Smart City Center", 
                        rating: "4.9", 
                        reviews: "112", 
                        lat: 26.2037, lng: 78.1574, // Dummy coords near Gwalior center
                        address: "City Center, Gwalior, Madhya Pradesh 474011",
                        tags: ["All Electronics", "Batteries", "+3 more"],
                        verified: true,
                        featured: true,
                        icon: "üèôÔ∏è"
                    },
                    { 
                        name: "Delhi E-Waste Drop-off", 
                        rating: "4.4", 
                        reviews: "156", 
                        lat: 28.6304, lng: 77.2177,
                        address: "Connaught Place, New Delhi, Delhi 110001",
                        tags: ["Laptops", "Phones", "Tablets", "+2 more"],
                        verified: false,
                        featured: false,
                        icon: "üõí"
                    },
                    { 
                        name: "GreenTech Recyclers Mumbai", 
                        rating: "4.8", 
                        reviews: "322", 
                        lat: 19.1136, lng: 72.8697,
                        address: "Andheri Kurla Road, Andheri East, Mumbai, Maharashtra 400059",
                        tags: ["Computers & Laptops", "Mobile Phones", "Tablets", "+6 more"],
                        verified: true,
                        featured: true,
                        icon: "üè≠"
                    },
                    { 
                        name: "EcoWaste Hub Bengaluru", 
                        rating: "4.6", 
                        reviews: "218", 
                        lat: 12.9698, lng: 77.7500,
                        address: "ITPL Main Rd, Whitefield, Bengaluru, Karnataka 560066",
                        tags: ["Computers", "Phones", "Tablets", "+4 more"],
                        verified: true,
                        featured: false,
                        icon: "‚ôªÔ∏è"
                    },
                    { 
                        name: "Hyderabad Circular Tech", 
                        rating: "4.9", 
                        reviews: "451", 
                        lat: 17.4483, lng: 78.3915,
                        address: "Hitech City Rd, Madhapur, Hyderabad, Telangana 500081",
                        tags: ["All Electronics", "Computers", "Phones", "+8 more"],
                        verified: true,
                        featured: true,
                        icon: "üîã"
                    }
                ];

                facilities.forEach(fac => {
                    let badges = '';
                    if(fac.verified) badges += `<span class="s-badge verified">‚úì Certified</span>`;
                    if(fac.featured) badges += `<span class="s-badge">Featured</span>`;

                    let tagsHtml = fac.tags.map(t => `<span class="s-tag">${t}</span>`).join('');
                    
                    // CALCULATE DISTANCE
                    let distKm = getDistanceFromLatLonInKm(originLat, originLng, fac.lat, fac.lng);
                    let distDisplay = distKm + " km";

                    // Directions Link
                    let mapsLink = `http://maps.google.com/maps?q=${encodeURIComponent(fac.address)}`;

                    solContainer.innerHTML += `
                        <div class="s-card">
                            <div class="s-img-container">
                                ${fac.icon}
                                <div class="s-badge-container">${badges}</div>
                            </div>
                            <div class="s-card-content">
                                <div class="s-card-header">
                                    <h3 class="s-card-title">${fac.name}</h3>
                                    <div class="s-rating">
                                        <span class="star">‚òÖ</span>${fac.rating} <span class="s-reviews">(${fac.reviews})</span>
                                    </div>
                                </div>
                                <div class="s-meta">
                                    <div class="s-meta-item">üìç ${distDisplay}</div>
                                    <div class="s-meta-item" style="font-size:0.8rem; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">${fac.address}</div>
                                    <div class="s-open">‚óè Open Now <span style="font-weight:400; color:#6b7280; font-size:0.75rem;">‚Ä¢ 9:00 AM - 6:00 PM</span></div>
                                </div>
                                <div class="s-tags">
                                    ${tagsHtml}
                                </div>
                                <div class="s-actions">
                                    <a href="${mapsLink}" target="_blank" class="btn btn-primary btn-sm btn-full">Directions ‚Üó</a>
                                    <button class="btn btn-outline btn-sm btn-full">Call</button>
                                </div>
                            </div>
                        </div>
                    `;
                });
            }
        });

        // --- 5. WIZARD LOGIC (Simplified) ---
        let currentStep = 1;
        let selectedCategory = '';
        function selectCategory(el, category) {
            document.querySelectorAll('.category-option').forEach(opt => opt.classList.remove('selected'));
            el.classList.add('selected');
            selectedCategory = category;
            document.getElementById('summary-cat').innerText = category;
        }
        function changeStep(dir) {
            if (currentStep === 1 && dir === 1 && !selectedCategory) { alert("Please select a category."); return; }
            document.getElementById(`step-content-${currentStep}`).classList.add('hidden');
            document.getElementById(`step-indicator-${currentStep}`).classList.remove('active');
            if(dir===1) document.getElementById(`step-indicator-${currentStep}`).classList.add('completed');
            currentStep += dir;
            document.getElementById(`step-content-${currentStep}`).classList.remove('hidden');
            document.getElementById(`step-indicator-${currentStep}`).classList.add('active');
            
            const nextBtn = document.getElementById('next-btn');
            document.getElementById('prev-btn').style.display = currentStep > 1 ? 'block' : 'none';
            if(currentStep === 5) { nextBtn.innerText = 'Submit Request'; nextBtn.onclick = submitForm; } 
            else { nextBtn.innerText = 'Continue >'; nextBtn.onclick = () => changeStep(1); }
        }
        function submitForm() { alert("Request Submitted! üå±"); location.reload(); }
        function handleFiles(files) {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = '';
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => { const img = document.createElement('img'); img.src = e.target.result; img.className = 'preview-img'; gallery.appendChild(img); };
                reader.readAsDataURL(file);
            });
        }

        // --- 6. ANIMATION & EXPORT ---
        function animateDashboard() {
            const animateValue = (id, end) => {
                const obj = document.getElementById(id);
                if(!obj || obj.innerText !== "0") return;
                let start = null; const dur = 1500;
                const step = (ts) => { if (!start) start = ts; const prog = Math.min((ts - start) / dur, 1); obj.innerHTML = Math.floor(prog * end).toLocaleString(); if (prog < 1) requestAnimationFrame(step); };
                requestAnimationFrame(step);
            };
            animateValue("total-devices", 45713); animateValue("total-co2", 235370); animateValue("total-users", 12366); animateValue("total-centers", 456);
        }
        function exportReport() {
            const csv = `EcoCircuit Report\nDevices: ${document.getElementById('total-devices').innerText}\nCO2: ${document.getElementById('total-co2').innerText}`;
            const blob = new Blob([csv], { type: 'text/csv' });
            const a = document.createElement('a'); a.href = window.URL.createObjectURL(blob); a.download = `Report_${Date.now()}.csv`; document.body.appendChild(a); a.click(); document.body.removeChild(a);
        }
        async function shareImpact() {
            try { await navigator.share({ title: 'EcoCircuit', text: 'Check my impact!', url: window.location.href }); } catch(e) { alert("Copied to clipboard!"); }
        }

        // --- 7. AI & CAMERA LOGIC ---
        let model = undefined;
        (async function() { 
            try { 
                model = await cocoSsd.load(); 
                document.getElementById('model-status').innerText = "AI Ready ‚úÖ"; 
            } catch (e) { console.error(e); } 
        })();

        async function startCamera() {
            const video = document.getElementById('webcam');
            if (!model) { alert("Loading AI..."); return; }
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });
                video.srcObject = stream;
                video.onloadedmetadata = () => { document.getElementById('placeholder').style.display = 'none'; detectFrame(video); };
            } catch (e) { alert("Camera Error: Permission denied or no camera found."); }
        }

        async function detectFrame(video) {
            const canvas = document.getElementById('canvas'); 
            const ctx = canvas.getContext('2d');
            canvas.width = video.videoWidth; 
            canvas.height = video.videoHeight;
            
            const predictions = await model.detect(video);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            let foundItem = false;

            if (predictions.length > 0) {
                predictions.forEach(p => {
                    // Confidence threshold > 55%
                    if (p.score > 0.55) {
                        const [x, y, w, h] = p.bbox;
                        const detectedClass = p.class.toLowerCase();
                        
                        // --- MAPPING LOGIC ---
                        // 1. Check if direct match exists in DB
                        let dbKey = null;
                        if (eWasteDB[detectedClass]) {
                            dbKey = detectedClass;
                        } 
                        // 2. If not, check the AI Map
                        else if (aiMap[detectedClass]) {
                            dbKey = aiMap[detectedClass];
                        }

                        // Draw Bounding Box
                        ctx.strokeStyle = dbKey ? '#10B981' : '#F59E0B'; // Green if recyclable, Orange if generic
                        ctx.lineWidth = 4; 
                        ctx.strokeRect(x, y, w, h);
                        
                        ctx.fillStyle = dbKey ? '#10B981' : '#F59E0B'; 
                        ctx.fillRect(x, y - 25, w, 25);
                        
                        ctx.fillStyle = '#fff'; 
                        // Show Mapped Name if available, otherwise raw AI class
                        const label = dbKey ? eWasteDB[dbKey].name : p.class.toUpperCase();
                        ctx.fillText(label, x + 5, y - 5);
                        
                        // Update Dashboard if it's a known e-waste item
                        if(dbKey) {
                            const data = eWasteDB[dbKey];
                            if(!foundItem) { // Only update dashboard for the first prominent item found
                                document.getElementById('item-name').innerText = data.name;
                                document.getElementById('val-co2').innerText = data.impact.co2;
                                document.getElementById('val-tree').innerText = data.impact.tree;
                                document.getElementById('val-energy').innerText = data.impact.energy;
                                document.getElementById('val-water').innerText = data.impact.water;
                                foundItem = true;
                            }
                        }
                    }
                });
            }
            requestAnimationFrame(() => detectFrame(video));
        }
    </script>
</body>
</html>